<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GClaude ‰ºÅÊ•≠ÁÆ°ÁêÜÁ≥ªÁµ± - Âì°Â∑•Â∑•‰ΩúÂè∞</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-info">
        <div class="container-fluid">
            <a class="navbar-brand" href="#"><i class="fas fa-user me-2"></i>Âì°Â∑•Â∑•‰ΩúÂè∞</a>
            <div class="navbar-nav ms-auto">
                <span class="navbar-text me-3">Ê≠°ËøéÔºå<span id="employee-name">Âì°Â∑•</span></span>
                <button class="btn btn-outline-light btn-sm" onclick="logout()">ÁôªÂá∫</button>
            </div>
        </div>
    </nav>

    <div class="container-fluid mt-4">
        <div class="row">
            <!-- ÂÅ¥ÈÇäÊ¨Ñ -->
            <div class="col-md-3 col-lg-2">
                <div class="list-group">
                    <a href="#dashboard" class="list-group-item list-group-item-action active" onclick="showSection('dashboard')">
                        <i class="fas fa-home me-2"></i>ÊàëÁöÑÈ¶ñÈ†Å
                    </a>
                    <a href="/punch-clock.html" class="list-group-item list-group-item-action">
                        <i class="fas fa-map-marker-alt me-2"></i>GPSÊâìÂç°
                    </a>
                    <a href="#schedule" class="list-group-item list-group-item-action" onclick="showSection('schedule')">
                        <i class="fas fa-calendar me-2"></i>ÊàëÁöÑÁè≠Ë°®
                    </a>
                    <a href="#revenue" class="list-group-item list-group-item-action" onclick="showSection('revenue')">
                        <i class="fas fa-cash-register me-2"></i>ÁáüÊî∂ÁôªË®ò
                    </a>
                    <a href="#maintenance" class="list-group-item list-group-item-action" onclick="showSection('maintenance')">
                        <i class="fas fa-tools me-2"></i>Á∂≠‰øÆÁî≥Ë´ã
                    </a>
                    <a href="/ordering.html" class="list-group-item list-group-item-action">
                        <i class="fas fa-shopping-cart me-2"></i>Âè´Ë≤®Á≥ªÁµ±
                    </a>
                    <a href="/promotion.html" class="list-group-item list-group-item-action">
                        <i class="fas fa-vote-yea me-2"></i>ÂçáÈÅ∑ÊäïÁ•®
                    </a>
                    <a href="#profile" class="list-group-item list-group-item-action" onclick="showSection('profile')">
                        <i class="fas fa-user-cog me-2"></i>ÂÄã‰∫∫Ë≥áÊñô
                    </a>
                </div>
            </div>

            <!-- ‰∏ªË¶ÅÂÖßÂÆπ -->
            <div class="col-md-9 col-lg-10">
                <!-- ÊàëÁöÑÈ¶ñÈ†Å -->
                <div id="dashboard-section" class="content-section">
                    <h2><i class="fas fa-home me-2"></i>ÊàëÁöÑÂ∑•‰ΩúÂè∞</h2>
                    
                    <!-- Âø´ÈÄüÊìç‰Ωú -->
                    <div class="row mb-4">
                        <div class="col-md-6 col-lg-3 mb-3">
                            <div class="card bg-success text-white h-100">
                                <div class="card-body text-center">
                                    <i class="fas fa-map-marker-alt fa-2x mb-2"></i>
                                    <h5>GPSÊâìÂç°</h5>
                                    <a href="/punch-clock.html" class="btn btn-light btn-sm">ÂâçÂæÄÊâìÂç°</a>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-3 mb-3">
                            <div class="card bg-info text-white h-100">
                                <div class="card-body text-center">
                                    <i class="fas fa-clock fa-2x mb-2"></i>
                                    <h5>Âá∫Âã§Ë®òÈåÑ</h5>
                                    <button class="btn btn-light btn-sm" onclick="showSection('attendance')">Êü•ÁúãË®òÈåÑ</button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-3 mb-3">
                            <div class="card bg-primary text-white h-100">
                                <div class="card-body text-center">
                                    <i class="fas fa-dollar-sign fa-2x mb-2"></i>
                                    <h5>ÁáüÊî∂ÁôªË®ò</h5>
                                    <button class="btn btn-light btn-sm" onclick="showSection('revenue')">ÂâçÂæÄÁôªË®ò</button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-3 mb-3">
                            <div class="card bg-warning text-white h-100">
                                <div class="card-body text-center">
                                    <i class="fas fa-wrench fa-2x mb-2"></i>
                                    <h5>Á∂≠‰øÆÁî≥Ë´ã</h5>
                                    <button class="btn btn-light btn-sm" onclick="showSection('maintenance')">ÂâçÂæÄÁî≥Ë´ã</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Á¨¨‰∫åÊéíÂø´ÈÄüÊìç‰Ωú -->
                    <div class="row mb-4">
                        <div class="col-md-6 col-lg-3 mb-3">
                            <div class="card bg-info text-white h-100">
                                <div class="card-body text-center">
                                    <i class="fas fa-shopping-cart fa-2x mb-2"></i>
                                    <h5>Âè´Ë≤®Á≥ªÁµ±</h5>
                                    <button class="btn btn-light btn-sm" onclick="window.location.href='/ordering.html'">ÂâçÂæÄÂè´Ë≤®</button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-3 mb-3">
                            <div class="card bg-secondary text-white h-100">
                                <div class="card-body text-center">
                                    <i class="fas fa-chart-line fa-2x mb-2"></i>
                                    <h5>ÁáüÊî∂ÂàÜÊûê</h5>
                                    <button class="btn btn-light btn-sm" onclick="showSection('revenue')">Ê™¢Ë¶ñÊï∏Êìö</button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-3 mb-3">
                            <div class="card bg-dark text-white h-100">
                                <div class="card-body text-center">
                                    <i class="fas fa-vote-yea fa-2x mb-2"></i>
                                    <h5>ÂçáÈÅ∑ÊäïÁ•®</h5>
                                    <button class="btn btn-light btn-sm" onclick="window.location.href='/promotion.html'">ÂèÉËàáÊäïÁ•®</button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-3 mb-3">
                            <div class="card bg-purple text-white h-100" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                                <div class="card-body text-center">
                                    <i class="fas fa-boxes fa-2x mb-2"></i>
                                    <h5>Â∫´Â≠òÊü•Ë©¢</h5>
                                    <button class="btn btn-light btn-sm" onclick="checkInventory()">Êü•ÁúãÂ∫´Â≠ò</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Á¨¨‰∫åÊéíÂø´Êç∑ÂäüËÉΩ -->
                    <div class="row mb-4">
                        <div class="col-md-6 col-lg-3 mb-3">
                            <div class="card bg-warning text-dark h-100">
                                <div class="card-body text-center">
                                    <i class="fas fa-calendar-alt fa-2x mb-2"></i>
                                    <h5>Âì°Â∑•ÊéíÁè≠</h5>
                                    <button class="btn btn-dark btn-sm" onclick="window.location.href='/schedule.html'">ÂâçÂæÄÊéíÁè≠</button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-3 mb-3">
                            <div class="card bg-success text-white h-100">
                                <div class="card-body text-center">
                                    <i class="fas fa-map-marker-alt fa-2x mb-2"></i>
                                    <h5>ÊâìÂç°Á≥ªÁµ±</h5>
                                    <button class="btn btn-light btn-sm" onclick="showSection('attendance')">ÊâìÂç°Ë®òÈåÑ</button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-3 mb-3">
                            <div class="card bg-danger text-white h-100">
                                <div class="card-body text-center">
                                    <i class="fas fa-wrench fa-2x mb-2"></i>
                                    <h5>Á∂≠‰øÆ‰øùÈ§ä</h5>
                                    <button class="btn btn-light btn-sm" onclick="showSection('maintenance')">Â†±‰øÆË®≠ÂÇô</button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-3 mb-3">
                            <div class="card text-white h-100" style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);">
                                <div class="card-body text-center">
                                    <i class="fas fa-bell fa-2x mb-2"></i>
                                    <h5>ÈÄöÁü•‰∏≠ÂøÉ</h5>
                                    <button class="btn btn-light btn-sm" onclick="showSection('notifications')">Êü•ÁúãÈÄöÁü•</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ‰ªäÊó•Áµ±Ë®à -->
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <div class="card">
                                <div class="card-header">
                                    <h6><i class="fas fa-clock me-1"></i>‰ªäÊó•Âá∫Âã§</h6>
                                </div>
                                <div class="card-body">
                                    <p class="mb-1">‰∏äÁè≠ÊôÇÈñì: <span id="clock-in-time">--:--</span></p>
                                    <p class="mb-1">‰∏ãÁè≠ÊôÇÈñì: <span id="clock-out-time">--:--</span></p>
                                    <p class="mb-0">Â∑•‰ΩúÊôÇÊï∏: <span id="work-hours">--</span></p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <div class="card">
                                <div class="card-header">
                                    <h6><i class="fas fa-calendar me-1"></i>Êú¨ÊúàÁµ±Ë®à</h6>
                                </div>
                                <div class="card-body">
                                    <p class="mb-1">Âá∫Âã§Â§©Êï∏: <span id="month-days">--</span></p>
                                    <p class="mb-1">Á∏ΩÂ∑•ÊôÇ: <span id="month-hours">--</span></p>
                                    <p class="mb-0">ÈÅ≤Âà∞Ê¨°Êï∏: <span id="late-count">--</span></p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <div class="card">
                                <div class="card-header">
                                    <h6><i class="fas fa-bell me-1"></i>Á≥ªÁµ±ÈÄöÁü•</h6>
                                </div>
                                <div class="card-body">
                                    <div id="notifications">
                                        <p class="text-muted">ÁÑ°Êñ∞ÈÄöÁü•</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ÊâìÂç°Á∞ΩÂà∞ -->
                <div id="attendance-section" class="content-section d-none">
                    <h2><i class="fas fa-clock me-2"></i>Âá∫Âã§ÊâìÂç°</h2>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h5>GPS ÊâìÂç°</h5>
                                </div>
                                <div class="card-body text-center">
                                    <div id="current-time" class="h3 text-primary mb-3"></div>
                                    <div id="location-status" class="mb-3">
                                        <i class="fas fa-spinner fa-spin"></i> Ê≠£Âú®ÂÆö‰Ωç...
                                    </div>
                                    <div class="btn-group" role="group">
                                        <button id="clock-in-btn" class="btn btn-success btn-lg" onclick="clockIn()">
                                            <i class="fas fa-sign-in-alt me-1"></i>‰∏äÁè≠ÊâìÂç°
                                        </button>
                                        <button id="clock-out-btn" class="btn btn-danger btn-lg" onclick="clockOut()">
                                            <i class="fas fa-sign-out-alt me-1"></i>‰∏ãÁè≠ÊâìÂç°
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h5>ÊúÄËøëÊâìÂç°Ë®òÈåÑ</h5>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-sm">
                                            <thead>
                                                <tr>
                                                    <th>Êó•Êúü</th>
                                                    <th>‰∏äÁè≠</th>
                                                    <th>‰∏ãÁè≠</th>
                                                    <th>ÁãÄÊÖã</th>
                                                </tr>
                                            </thead>
                                            <tbody id="attendance-history">
                                                <tr>
                                                    <td colspan="4" class="text-center">ËºâÂÖ•‰∏≠...</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ÊàëÁöÑÁè≠Ë°® -->
                <div id="schedule-section" class="content-section d-none">
                    <h2><i class="fas fa-calendar me-2"></i>ÊàëÁöÑÁè≠Ë°®</h2>
                    
                    <!-- Áè≠Ë°®ÊéßÂà∂ -->
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <div class="btn-group" role="group">
                                <button class="btn btn-primary" onclick="showWeekSchedule()">Êú¨ÈÄ±Áè≠Ë°®</button>
                                <button class="btn btn-outline-primary" onclick="showMonthSchedule()">Êú¨ÊúàÁè≠Ë°®</button>
                            </div>
                        </div>
                        <div class="col-md-6 text-end">
                            <button class="btn btn-success" onclick="requestLeave()"><i class="fas fa-calendar-times me-1"></i>Ë´ãÂÅáÁî≥Ë´ã</button>
                        </div>
                    </div>
                    
                    <!-- Êú¨ÈÄ±Áè≠Ë°® -->
                    <div id="week-schedule" class="card">
                        <div class="card-header">
                            <h5><i class="fas fa-calendar-week me-1"></i>Êú¨ÈÄ±Áè≠Ë°® (2025Âπ¥8Êúà11Êó• - 8Êúà17Êó•)</h5>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-bordered text-center">
                                    <thead class="table-primary">
                                        <tr>
                                            <th>ÊôÇÊÆµ</th>
                                            <th>ÈÄ±‰∏Ä<br><small>8/11</small></th>
                                            <th>ÈÄ±‰∫å<br><small>8/12</small></th>
                                            <th>ÈÄ±‰∏â<br><small>8/13</small></th>
                                            <th>ÈÄ±Âõõ<br><small>8/14</small></th>
                                            <th>ÈÄ±‰∫î<br><small>8/15</small></th>
                                            <th>ÈÄ±ÂÖ≠<br><small>8/16</small></th>
                                            <th>ÈÄ±Êó•<br><small>8/17</small></th>
                                        </tr>
                                    </thead>
                                    <tbody id="week-schedule-body">
                                        <tr>
                                            <td class="table-secondary"><strong>Êó©Áè≠<br>09:00-17:00</strong></td>
                                            <td class="bg-success text-white">‚úì Ê≠£Áè≠</td>
                                            <td class="bg-success text-white">‚úì Ê≠£Áè≠</td>
                                            <td class="bg-success text-white">‚úì Ê≠£Áè≠</td>
                                            <td class="bg-success text-white">‚úì Ê≠£Áè≠</td>
                                            <td class="bg-success text-white">‚úì Ê≠£Áè≠</td>
                                            <td class="bg-secondary text-white">‰ºëÂÅá</td>
                                            <td class="bg-secondary text-white">‰ºëÂÅá</td>
                                        </tr>
                                        <tr>
                                            <td class="table-secondary"><strong>ÊôöÁè≠<br>14:00-22:00</strong></td>
                                            <td class="bg-light">-</td>
                                            <td class="bg-light">-</td>
                                            <td class="bg-light">-</td>
                                            <td class="bg-light">-</td>
                                            <td class="bg-light">-</td>
                                            <td class="bg-light">-</td>
                                            <td class="bg-light">-</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Êú¨ÊúàÁè≠Ë°®ÊëòË¶Å -->
                    <div id="month-schedule" class="card d-none">
                        <div class="card-header">
                            <h5><i class="fas fa-calendar-alt me-1"></i>Êú¨ÊúàÁè≠Ë°®ÊëòË¶Å (2025Âπ¥8Êúà)</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="text-center p-3 border rounded">
                                        <h4 class="text-primary">22</h4>
                                        <p class="mb-0">Â∑•‰ΩúÂ§©Êï∏</p>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="text-center p-3 border rounded">
                                        <h4 class="text-success">176</h4>
                                        <p class="mb-0">È†êË®àÂ∑•ÊôÇ</p>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="text-center p-3 border rounded">
                                        <h4 class="text-warning">8</h4>
                                        <p class="mb-0">‰ºëÂÅáÂ§©Êï∏</p>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="text-center p-3 border rounded">
                                        <h4 class="text-info">2</h4>
                                        <p class="mb-0">Âä†Áè≠Â§©Êï∏</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ë´ãÂÅáË®òÈåÑ -->
                    <div class="card mt-3">
                        <div class="card-header">
                            <h6><i class="fas fa-history me-1"></i>ÊúÄËøëË´ãÂÅáË®òÈåÑ</h6>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-sm">
                                    <thead>
                                        <tr>
                                            <th>Áî≥Ë´ãÊó•Êúü</th>
                                            <th>Ë´ãÂÅáÈ°ûÂûã</th>
                                            <th>Ë´ãÂÅáÊó•Êúü</th>
                                            <th>Â§©Êï∏</th>
                                            <th>ÁãÄÊÖã</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>2025-08-10</td>
                                            <td>Âπ¥ÂÅá</td>
                                            <td>2025-08-16</td>
                                            <td>1Â§©</td>
                                            <td><span class="badge bg-success">Â∑≤Ê†∏ÂáÜ</span></td>
                                        </tr>
                                        <tr>
                                            <td>2025-08-05</td>
                                            <td>ÁóÖÂÅá</td>
                                            <td>2025-08-07</td>
                                            <td>0.5Â§©</td>
                                            <td><span class="badge bg-success">Â∑≤Ê†∏ÂáÜ</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ÁáüÊî∂ÁôªË®ò -->
                <div id="revenue-section" class="content-section d-none">
                    <h2><i class="fas fa-cash-register me-2"></i>ÁáüÊî∂ÁôªË®ò</h2>
                    
                    <!-- Âø´ÈÄüÁôªË®ò -->
                    <div class="row mb-4">
                        <div class="col-md-8">
                            <div class="card">
                                <div class="card-header">
                                    <h5><i class="fas fa-plus me-1"></i>Êñ∞Â¢ûÁáüÊî∂Ë®òÈåÑ</h5>
                                </div>
                                <div class="card-body">
                                    <form id="revenue-form">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label class="form-label">ÁáüÊî∂È°ûÂà•</label>
                                                    <select class="form-select" id="revenue-category" required>
                                                        <option value="">Ë´ãÈÅ∏ÊìáÈ°ûÂà•</option>
                                                        <option value="product_sales">Áî¢ÂìÅÈä∑ÂîÆ</option>
                                                        <option value="service_income">ÊúçÂãôÊî∂ÂÖ•</option>
                                                        <option value="maintenance_fee">Á∂≠Ë≠∑Ë≤ªÁî®</option>
                                                        <option value="consultation">Ë´ÆË©¢Ë≤ªÁî®</option>
                                                        <option value="other">ÂÖ∂‰ªñ</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label class="form-label">È†ÖÁõÆÂêçÁ®±</label>
                                                    <input type="text" class="form-control" id="revenue-item" placeholder="Ëº∏ÂÖ•È†ÖÁõÆÂêçÁ®±" required>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label class="form-label">ÈáëÈ°ç (NT$)</label>
                                                    <input type="number" class="form-control" id="revenue-amount" placeholder="0" min="0" step="1" required>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label class="form-label">ÂÆ¢Êà∂ÂßìÂêç</label>
                                                    <input type="text" class="form-control" id="revenue-customer" placeholder="ÂÆ¢Êà∂ÂßìÂêç" required>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">ÂÇôË®ª</label>
                                            <textarea class="form-control" id="revenue-notes" rows="2" placeholder="ÁáüÊî∂Ë©≥Á¥∞Ë™™Êòé..." maxlength="200"></textarea>
                                        </div>
                                        <div class="d-grid">
                                            <button type="submit" class="btn btn-primary"><i class="fas fa-save me-1"></i>ÂÑ≤Â≠òÁáüÊî∂Ë®òÈåÑ</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-header">
                                    <h6><i class="fas fa-chart-pie me-1"></i>‰ªäÊó•ÁáüÊî∂Áµ±Ë®à</h6>
                                </div>
                                <div class="card-body text-center">
                                    <h3 class="text-success" id="today-revenue-total">NT$ 45,800</h3>
                                    <p class="text-muted mb-2">‰ªäÊó•Á∏ΩÁáüÊî∂</p>
                                    <hr>
                                    <div class="d-flex justify-content-between">
                                        <small>Áî¢ÂìÅÈä∑ÂîÆ:</small>
                                        <small class="text-success">NT$ 32,000</small>
                                    </div>
                                    <div class="d-flex justify-content-between">
                                        <small>ÊúçÂãôÊî∂ÂÖ•:</small>
                                        <small class="text-info">NT$ 8,500</small>
                                    </div>
                                    <div class="d-flex justify-content-between">
                                        <small>ÂÖ∂‰ªñ:</small>
                                        <small class="text-warning">NT$ 5,300</small>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card mt-3">
                                <div class="card-header">
                                    <h6><i class="fas fa-target me-1"></i>Êú¨ÊúàÁõÆÊ®ô</h6>
                                </div>
                                <div class="card-body">
                                    <div class="progress mb-2">
                                        <div class="progress-bar bg-success" style="width: 68%"></div>
                                    </div>
                                    <div class="d-flex justify-content-between">
                                        <small>Â∑≤ÈÅîÊàê: 68%</small>
                                        <small>ÁõÆÊ®ô: NT$ 500,000</small>
                                    </div>
                                    <p class="mt-2 mb-0"><strong>ÁõÆÂâç: NT$ 340,000</strong></p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ÊúÄËøëË®òÈåÑ -->
                    <div class="card">
                        <div class="card-header">
                            <h5><i class="fas fa-list me-1"></i>ÊàëÁöÑÁáüÊî∂Ë®òÈåÑ</h5>
                            <button class="btn btn-sm btn-outline-secondary float-end" onclick="exportRevenueData()"><i class="fas fa-download me-1"></i>ÂåØÂá∫</button>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-striped">
                                    <thead>
                                        <tr>
                                            <th>Êó•ÊúüÊôÇÈñì</th>
                                            <th>È°ûÂà•</th>
                                            <th>È†ÖÁõÆ</th>
                                            <th>ÂÆ¢Êà∂</th>
                                            <th>ÈáëÈ°ç</th>
                                            <th>ÁãÄÊÖã</th>
                                            <th>Êìç‰Ωú</th>
                                        </tr>
                                    </thead>
                                    <tbody id="revenue-records">
                                        <tr>
                                            <td>2025-08-15 14:30</td>
                                            <td><span class="badge bg-primary">Áî¢ÂìÅÈä∑ÂîÆ</span></td>
                                            <td>AÁ¥öÁî¢ÂìÅÂ•óÁµÑ</td>
                                            <td>ÂºµÂÖàÁîü</td>
                                            <td class="text-success">NT$ 15,000</td>
                                            <td><span class="badge bg-success">Â∑≤Á¢∫Ë™ç</span></td>
                                            <td>
                                                <button class="btn btn-sm btn-outline-info" onclick="viewRevenueDetail(1)"><i class="fas fa-eye"></i></button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>2025-08-15 11:15</td>
                                            <td><span class="badge bg-info">ÊúçÂãôÊî∂ÂÖ•</span></td>
                                            <td>Á≥ªÁµ±Á∂≠Ë≠∑</td>
                                            <td>ÊùéÂ∞èÂßê</td>
                                            <td class="text-success">NT$ 8,500</td>
                                            <td><span class="badge bg-warning">ÂæÖÁ¢∫Ë™ç</span></td>
                                            <td>
                                                <button class="btn btn-sm btn-outline-info" onclick="viewRevenueDetail(2)"><i class="fas fa-eye"></i></button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>2025-08-15 09:45</td>
                                            <td><span class="badge bg-success">Ë´ÆË©¢Ë≤ªÁî®</span></td>
                                            <td>Â∞àÊ•≠Ë´ÆË©¢</td>
                                            <td>ÁéãÁ∂ìÁêÜ</td>
                                            <td class="text-success">NT$ 5,300</td>
                                            <td><span class="badge bg-success">Â∑≤Á¢∫Ë™ç</span></td>
                                            <td>
                                                <button class="btn btn-sm btn-outline-info" onclick="viewRevenueDetail(3)"><i class="fas fa-eye"></i></button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Á∂≠‰øÆÁî≥Ë´ã -->
                <div id="maintenance-section" class="content-section d-none">
                    <h2><i class="fas fa-tools me-2"></i>Á∂≠‰øÆÁî≥Ë´ã</h2>
                    
                    <!-- Êñ∞Â¢ûÁî≥Ë´ã -->
                    <div class="row mb-4">
                        <div class="col-md-8">
                            <div class="card">
                                <div class="card-header">
                                    <h5><i class="fas fa-plus me-1"></i>Êèê‰∫§Á∂≠‰øÆÁî≥Ë´ã</h5>
                                </div>
                                <div class="card-body">
                                    <form id="maintenance-form">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label class="form-label">Ë®≠ÂÇôÈ°ûÂûã</label>
                                                    <select class="form-select" id="equipment-type" required>
                                                        <option value="">Ë´ãÈÅ∏ÊìáË®≠ÂÇô</option>
                                                        <option value="computer">ÈõªËÖ¶Ë®≠ÂÇô</option>
                                                        <option value="printer">Âç∞Ë°®Ê©ü</option>
                                                        <option value="air_conditioning">Á©∫Ë™øÁ≥ªÁµ±</option>
                                                        <option value="lighting">ÁÖßÊòéË®≠ÂÇô</option>
                                                        <option value="network">Á∂≤Ë∑ØË®≠ÂÇô</option>
                                                        <option value="furniture">Ëæ¶ÂÖ¨ÂÆ∂ÂÖ∑</option>
                                                        <option value="security">ÂÆâÂÖ®Ë®≠ÂÇô</option>
                                                        <option value="other">ÂÖ∂‰ªñ</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label class="form-label">Á∑äÊÄ•Á®ãÂ∫¶</label>
                                                    <select class="form-select" id="priority-level" required>
                                                        <option value="">Ë´ãÈÅ∏ÊìáÁ®ãÂ∫¶</option>
                                                        <option value="low">üü¢ ‰Ωé - ‰∏çÂΩ±ÈüøÂ∑•‰Ωú</option>
                                                        <option value="medium">üü° ‰∏≠ - Á®çÂæÆÂΩ±Èüø</option>
                                                        <option value="high">üî¥ È´ò - Âö¥ÈáçÂΩ±Èüø</option>
                                                        <option value="urgent">‚ö° Á∑äÊÄ• - ÁÑ°Ê≥ïÂ∑•‰Ωú</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label class="form-label">Ë®≠ÂÇô‰ΩçÁΩÆ</label>
                                                    <input type="text" class="form-control" id="equipment-location" placeholder="‰æãÔºö3Ê®ìÊúÉË≠∞ÂÆ§" required>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label class="form-label">ËÅØÁµ°ÈõªË©±</label>
                                                    <input type="tel" class="form-control" id="contact-phone" placeholder="ÂàÜÊ©üÊàñÊâãÊ©ü" required>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">ÂïèÈ°åÊ®ôÈ°å</label>
                                            <input type="text" class="form-control" id="maintenance-title" placeholder="Á∞°Ëø∞ÂïèÈ°å" maxlength="100" required>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">Ë©≥Á¥∞ÊèèËø∞</label>
                                            <textarea class="form-control" id="maintenance-description" rows="4" placeholder="Ë´ãË©≥Á¥∞ÊèèËø∞ÂïèÈ°åÁãÄÊ≥Å„ÄÅÁôºÁîüÊôÇÈñì„ÄÅÂΩ±ÈüøÁØÑÂúçÁ≠â..." maxlength="500" required></textarea>
                                            <div class="form-text">Ââ©È§òÂ≠óÊï∏: <span id="char-count">500</span></div>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">ÈôÑÂä†ÁÖßÁâá (ÈÅ∏Â°´)</label>
                                            <input type="file" class="form-control" id="maintenance-photos" accept="image/*" multiple>
                                            <div class="form-text">ÂèØ‰∏äÂÇ≥Â§öÂºµÁÖßÁâáÔºåÊîØÊè¥ JPG, PNG Ê†ºÂºè</div>
                                        </div>
                                        <div class="d-grid">
                                            <button type="submit" class="btn btn-danger"><i class="fas fa-paper-plane me-1"></i>Êèê‰∫§Á∂≠‰øÆÁî≥Ë´ã</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-header">
                                    <h6><i class="fas fa-info-circle me-1"></i>Áî≥Ë´ãÈ†àÁü•</h6>
                                </div>
                                <div class="card-body">
                                    <div class="alert alert-info">
                                        <h6><i class="fas fa-clock me-1"></i>ËôïÁêÜÊôÇÈñì</h6>
                                        <ul class="mb-0">
                                            <li>üü¢ ‰Ωé: 3-5ÂÄãÂ∑•‰ΩúÂ§©</li>
                                            <li>üü° ‰∏≠: 1-2ÂÄãÂ∑•‰ΩúÂ§©</li>
                                            <li>üî¥ È´ò: 4-8Â∞èÊôÇ</li>
                                            <li>‚ö° Á∑äÊÄ•: Á´ãÂç≥ËôïÁêÜ</li>
                                        </ul>
                                    </div>
                                    <div class="alert alert-warning">
                                        <h6><i class="fas fa-exclamation-triangle me-1"></i>Ê≥®ÊÑè‰∫ãÈ†Ö</h6>
                                        <ul class="mb-0">
                                            <li>Ë´ãÊ∫ñÁ¢∫Â°´ÂØ´Ë®≠ÂÇô‰ΩçÁΩÆ</li>
                                            <li>Ë©≥Á¥∞ÊèèËø∞ÊúâÂä©Âø´ÈÄüÊéíÈô§</li>
                                            <li>Á∑äÊÄ•ÊÉÖÊ≥ÅË´ãÂêåÊôÇÈõªË©±ËÅØÁπ´</li>
                                            <li>ÁÖßÁâáÊúâÂä©ÊñºÂïèÈ°åÂà§Êñ∑</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ÊàëÁöÑÁî≥Ë´ãË®òÈåÑ -->
                    <div class="card">
                        <div class="card-header">
                            <h5><i class="fas fa-history me-1"></i>ÊàëÁöÑÁî≥Ë´ãË®òÈåÑ</h5>
                            <div class="btn-group btn-group-sm float-end" role="group">
                                <button class="btn btn-outline-secondary" onclick="filterMaintenanceStatus('all')">ÂÖ®ÈÉ®</button>
                                <button class="btn btn-outline-warning" onclick="filterMaintenanceStatus('pending')">ÂæÖËôïÁêÜ</button>
                                <button class="btn btn-outline-primary" onclick="filterMaintenanceStatus('in_progress')">ËôïÁêÜ‰∏≠</button>
                                <button class="btn btn-outline-success" onclick="filterMaintenanceStatus('completed')">Â∑≤ÂÆåÊàê</button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-striped">
                                    <thead>
                                        <tr>
                                            <th>Áî≥Ë´ãÊôÇÈñì</th>
                                            <th>Ë®≠ÂÇôÈ°ûÂûã</th>
                                            <th>ÂïèÈ°åÊ®ôÈ°å</th>
                                            <th>‰ΩçÁΩÆ</th>
                                            <th>Á∑äÊÄ•Á®ãÂ∫¶</th>
                                            <th>ÁãÄÊÖã</th>
                                            <th>ËôïÁêÜ‰∫∫Âì°</th>
                                            <th>Êìç‰Ωú</th>
                                        </tr>
                                    </thead>
                                    <tbody id="maintenance-records">
                                        <tr data-status="pending">
                                            <td>2025-08-15 09:15</td>
                                            <td><i class="fas fa-snowflake text-info"></i> Á©∫Ë™øÁ≥ªÁµ±</td>
                                            <td>‰∏âÊ®ìÊúÉË≠∞ÂÆ§Á©∫Ë™ø‰∏çÂÜ∑</td>
                                            <td>3F-ÊúÉË≠∞ÂÆ§A</td>
                                            <td><span class="badge bg-danger">üî¥ È´ò</span></td>
                                            <td><span class="badge bg-warning">ÂæÖËôïÁêÜ</span></td>
                                            <td>-</td>
                                            <td>
                                                <button class="btn btn-sm btn-outline-info" onclick="viewMaintenanceDetail(1)"><i class="fas fa-eye"></i></button>
                                                <button class="btn btn-sm btn-outline-danger" onclick="cancelMaintenance(1)"><i class="fas fa-times"></i></button>
                                            </td>
                                        </tr>
                                        <tr data-status="in_progress">
                                            <td>2025-08-14 14:30</td>
                                            <td><i class="fas fa-print text-secondary"></i> Âç∞Ë°®Ê©ü</td>
                                            <td>‰∫åÊ®ìÂç∞Ë°®Ê©üÁ∂ìÂ∏∏Âç°Á¥ô</td>
                                            <td>2F-Ëæ¶ÂÖ¨ÂçÄ</td>
                                            <td><span class="badge bg-warning">üü° ‰∏≠</span></td>
                                            <td><span class="badge bg-primary">ËôïÁêÜ‰∏≠</span></td>
                                            <td>Á∂≠‰øÆÈÉ®-Â∞èÁéã</td>
                                            <td>
                                                <button class="btn btn-sm btn-outline-info" onclick="viewMaintenanceDetail(2)"><i class="fas fa-eye"></i></button>
                                            </td>
                                        </tr>
                                        <tr data-status="completed">
                                            <td>2025-08-13 16:45</td>
                                            <td><i class="fas fa-lightbulb text-warning"></i> ÁÖßÊòéË®≠ÂÇô</td>
                                            <td>Ëæ¶ÂÖ¨ÂÆ§Êó•ÂÖâÁáàÈñÉÁàç</td>
                                            <td>1F-Ë≤°ÂãôÈÉ®</td>
                                            <td><span class="badge bg-success">üü¢ ‰Ωé</span></td>
                                            <td><span class="badge bg-success">Â∑≤ÂÆåÊàê</span></td>
                                            <td>ÈõªÂ∑•-ËÄÅÊùé</td>
                                            <td>
                                                <button class="btn btn-sm btn-outline-info" onclick="viewMaintenanceDetail(3)"><i class="fas fa-eye"></i></button>
                                                <button class="btn btn-sm btn-outline-success" onclick="rateMaintenance(3)"><i class="fas fa-star"></i></button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ÂÄã‰∫∫Ë≥áÊñô -->
                <div id="profile-section" class="content-section d-none">
                    <h2><i class="fas fa-user-cog me-2"></i>ÂÄã‰∫∫Ë≥áÊñô</h2>
                    <div class="card">
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <h5>Âü∫Êú¨Ë≥áÊñô</h5>
                                    <table class="table table-borderless">
                                        <tr><th>ÂßìÂêç:</th><td id="profile-name">--</td></tr>
                                        <tr><th>Âì°Â∑•Á∑®Ëôü:</th><td id="profile-id">--</td></tr>
                                        <tr><th>ËÅ∑‰Ωç:</th><td id="profile-role">--</td></tr>
                                        <tr><th>ÈÉ®ÈñÄ:</th><td id="profile-department">--</td></tr>
                                        <tr><th>ÈõªË©±:</th><td id="profile-phone">--</td></tr>
                                        <tr><th>‰ø°ÁÆ±:</th><td id="profile-email">--</td></tr>
                                    </table>
                                </div>
                                <div class="col-md-6">
                                    <h5>‰øÆÊîπÂØÜÁ¢º</h5>
                                    <div class="mb-3">
                                        <label class="form-label">ËàäÂØÜÁ¢º</label>
                                        <input type="password" class="form-control" id="old-password">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Êñ∞ÂØÜÁ¢º</label>
                                        <input type="password" class="form-control" id="new-password">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Á¢∫Ë™çÊñ∞ÂØÜÁ¢º</label>
                                        <input type="password" class="form-control" id="confirm-password">
                                    </div>
                                    <button class="btn btn-primary" onclick="changePassword()">‰øÆÊîπÂØÜÁ¢º</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Ê™¢Êü•Âì°Â∑•Ê¨äÈôê
        function checkEmployeeAuth() {
            const token = localStorage.getItem('jwt_token');
            const user = JSON.parse(localStorage.getItem('user_data') || '{}');
            
            if (!token || !user) {
                alert('Ë´ãÂÖàÁôªÂÖ•');
                window.location.href = '/login.html';
                return false;
            }
            
            document.getElementById('employee-name').textContent = user.name;
            return true;
        }

        // È°ØÁ§∫ÊåáÂÆöÂçÄÂ°ä
        function showSection(sectionName) {
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.add('d-none');
            });
            
            document.querySelectorAll('.list-group-item').forEach(item => {
                item.classList.remove('active');
            });
            
            document.getElementById(sectionName + '-section').classList.remove('d-none');
            document.querySelector(`[onclick="showSection('${sectionName}')"]`).classList.add('active');
            
            if (sectionName === 'dashboard') loadDashboard();
            if (sectionName === 'attendance') loadAttendance();
            if (sectionName === 'profile') loadProfile();
        }

        // ËºâÂÖ•È¶ñÈ†ÅÊï∏Êìö
        async function loadDashboard() {
            const token = localStorage.getItem('jwt_token');
            
            try {
                // ËºâÂÖ•‰ªäÊó•Âá∫Âã§
                const response = await fetch('/api/attendance/today', {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                
                if (response.ok) {
                    const attendance = await response.json();
                    document.getElementById('clock-in-time').textContent = 
                        attendance.clock_in ? new Date(attendance.clock_in).toLocaleTimeString() : '--:--';
                    document.getElementById('clock-out-time').textContent = 
                        attendance.clock_out ? new Date(attendance.clock_out).toLocaleTimeString() : '--:--';
                    
                    if (attendance.clock_in && attendance.clock_out) {
                        const hours = (new Date(attendance.clock_out) - new Date(attendance.clock_in)) / (1000 * 60 * 60);
                        document.getElementById('work-hours').textContent = hours.toFixed(1) + ' Â∞èÊôÇ';
                    }
                }
            } catch (error) {
                console.error('ËºâÂÖ•È¶ñÈ†ÅÊï∏ÊìöÂ§±Êïó:', error);
            }
        }

        // ËºâÂÖ•Âá∫Âã§È†ÅÈù¢
        function loadAttendance() {
            updateCurrentTime();
            getCurrentLocation();
            loadAttendanceHistory();
            
            // ÊØèÁßíÊõ¥Êñ∞ÊôÇÈñì
            setInterval(updateCurrentTime, 1000);
        }

        // ËºâÂÖ•ÂÄã‰∫∫Ë≥áÊñô
        function loadProfile() {
            const user = JSON.parse(localStorage.getItem('user_data') || '{}');
            
            document.getElementById('profile-name').textContent = user.name || '--';
            document.getElementById('profile-id').textContent = user.employee_id || '--';
            document.getElementById('profile-role').textContent = user.role || '--';
            document.getElementById('profile-department').textContent = user.department_name || '--';
            document.getElementById('profile-phone').textContent = user.phone || '--';
            document.getElementById('profile-email').textContent = user.email || '--';
        }

        // Êõ¥Êñ∞Áï∂ÂâçÊôÇÈñì
        function updateCurrentTime() {
            const now = new Date();
            document.getElementById('current-time').textContent = now.toLocaleTimeString('zh-TW');
        }

        // Áç≤ÂèñÁï∂Ââç‰ΩçÁΩÆ
        function getCurrentLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    function(position) {
                        document.getElementById('location-status').innerHTML = 
                            '<i class="fas fa-map-marker-alt text-success"></i> ÂÆö‰ΩçÊàêÂäü';
                    },
                    function(error) {
                        document.getElementById('location-status').innerHTML = 
                            '<i class="fas fa-exclamation-triangle text-warning"></i> ÂÆö‰ΩçÂ§±Êïó';
                    }
                );
            } else {
                document.getElementById('location-status').innerHTML = 
                    '<i class="fas fa-times text-danger"></i> ‰∏çÊîØÊè¥ÂÆö‰Ωç';
            }
        }

        // ËºâÂÖ•Âá∫Âã§Ë®òÈåÑ
        async function loadAttendanceHistory() {
            const token = localStorage.getItem('jwt_token');
            
            try {
                const response = await fetch('/api/attendance/history?limit=5', {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                
                if (response.ok) {
                    const history = await response.json();
                    const tbody = document.getElementById('attendance-history');
                    
                    if (history.length === 0) {
                        tbody.innerHTML = '<tr><td colspan="4" class="text-center">ÁÑ°Ë®òÈåÑ</td></tr>';
                    } else {
                        tbody.innerHTML = history.map(record => `
                            <tr>
                                <td>${new Date(record.date).toLocaleDateString()}</td>
                                <td>${record.clock_in ? new Date(record.clock_in).toLocaleTimeString() : '--'}</td>
                                <td>${record.clock_out ? new Date(record.clock_out).toLocaleTimeString() : '--'}</td>
                                <td><span class="badge bg-success">Ê≠£Â∏∏</span></td>
                            </tr>
                        `).join('');
                    }
                }
            } catch (error) {
                console.error('ËºâÂÖ•Âá∫Âã§Ë®òÈåÑÂ§±Êïó:', error);
            }
        }

        // ‰∏äÁè≠ÊâìÂç°
        async function clockIn() {
            const token = localStorage.getItem('jwt_token');
            
            try {
                const response = await fetch('/api/attendance/clock-in', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        location: 'GPSÂÆö‰Ωç‰∏≠...'
                    })
                });
                
                if (response.ok) {
                    alert('‰∏äÁè≠ÊâìÂç°ÊàêÂäüÔºÅ');
                    loadDashboard();
                    loadAttendance();
                } else {
                    const error = await response.json();
                    alert('ÊâìÂç°Â§±ÊïóÔºö' + error.message);
                }
            } catch (error) {
                alert('ÊâìÂç°Â§±ÊïóÔºö' + error.message);
            }
        }

        // ‰∏ãÁè≠ÊâìÂç°
        async function clockOut() {
            const token = localStorage.getItem('jwt_token');
            
            try {
                const response = await fetch('/api/attendance/clock-out', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        location: 'GPSÂÆö‰Ωç‰∏≠...'
                    })
                });
                
                if (response.ok) {
                    alert('‰∏ãÁè≠ÊâìÂç°ÊàêÂäüÔºÅ');
                    loadDashboard();
                    loadAttendance();
                } else {
                    const error = await response.json();
                    alert('ÊâìÂç°Â§±ÊïóÔºö' + error.message);
                }
            } catch (error) {
                alert('ÊâìÂç°Â§±ÊïóÔºö' + error.message);
            }
        }

        // ==================== Áè≠Ë°®Áõ∏ÈóúÂäüËÉΩ ====================
        
        // È°ØÁ§∫ÈÄ±Áè≠Ë°®
        function showWeekSchedule() {
            document.getElementById('week-schedule').classList.remove('d-none');
            document.getElementById('month-schedule').classList.add('d-none');
        }
        
        // È°ØÁ§∫ÊúàÁè≠Ë°®
        function showMonthSchedule() {
            document.getElementById('week-schedule').classList.add('d-none');
            document.getElementById('month-schedule').classList.remove('d-none');
        }
        
        // Ë´ãÂÅáÁî≥Ë´ã
        function requestLeave() {
            const html = `
                <form id="leave-request-form">
                    <div class="mb-3">
                        <label class="form-label">Ë´ãÂÅáÈ°ûÂûã</label>
                        <select class="form-select" id="leave-type" required>
                            <option value="">Ë´ãÈÅ∏ÊìáË´ãÂÅáÈ°ûÂûã</option>
                            <option value="annual">Âπ¥ÂÅá</option>
                            <option value="sick">ÁóÖÂÅá</option>
                            <option value="personal">‰∫ãÂÅá</option>
                            <option value="maternity">Áî¢ÂÅá</option>
                            <option value="paternity">Èô™Áî¢ÂÅá</option>
                            <option value="other">ÂÖ∂‰ªñ</option>
                        </select>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Ëµ∑ÂßãÊó•Êúü</label>
                                <input type="date" class="form-control" id="leave-start-date" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">ÁµêÊùüÊó•Êúü</label>
                                <input type="date" class="form-control" id="leave-end-date" required>
                            </div>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Ë´ãÂÅáÂéüÂõ†</label>
                        <textarea class="form-control" id="leave-reason" rows="3" placeholder="Ë´ãË™™ÊòéË´ãÂÅáÂéüÂõ†..." required></textarea>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">‰ª£ÁêÜ‰∫∫ (ÈÅ∏Â°´)</label>
                        <input type="text" class="form-control" id="leave-substitute" placeholder="‰ª£ÁêÜ‰∫∫ÂßìÂêç">
                    </div>
                </form>
            `;
            
            showModal('Ë´ãÂÅáÁî≥Ë´ã', html, async () => {
                const formData = new FormData(document.getElementById('leave-request-form'));
                const leaveData = Object.fromEntries(formData);
                
                try {
                    const response = await fetch('/api/leave-requests', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${localStorage.getItem('jwt_token')}`
                        },
                        body: JSON.stringify(leaveData)
                    });
                    
                    if (response.ok) {
                        showAlert('Ë´ãÂÅáÁî≥Ë´ãÂ∑≤Êèê‰∫§ÔºåÁ≠âÂæÖ‰∏ªÁÆ°ÂØ©Ê†∏', 'success');
                    } else {
                        showAlert('Ë´ãÂÅáÁî≥Ë´ãÂ§±Êïó', 'error');
                    }
                } catch (error) {
                    showAlert('Ë´ãÂÅáÁî≥Ë´ãÂ§±Êïó: ' + error.message, 'error');
                }
            });
        }
        
        // ==================== ÁáüÊî∂Áõ∏ÈóúÂäüËÉΩ ====================
        
        // ËôïÁêÜÁáüÊî∂Ë°®ÂñÆÊèê‰∫§
        document.addEventListener('DOMContentLoaded', function() {
            const revenueForm = document.getElementById('revenue-form');
            if (revenueForm) {
                revenueForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    const formData = {
                        category: document.getElementById('revenue-category').value,
                        item: document.getElementById('revenue-item').value,
                        amount: parseFloat(document.getElementById('revenue-amount').value),
                        customer: document.getElementById('revenue-customer').value,
                        notes: document.getElementById('revenue-notes').value
                    };
                    
                    try {
                        const response = await fetch('/api/revenue', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                                'Authorization': `Bearer ${localStorage.getItem('jwt_token')}`
                            },
                            body: JSON.stringify(formData)
                        });
                        
                        if (response.ok) {
                            showAlert('ÁáüÊî∂Ë®òÈåÑÊñ∞Â¢ûÊàêÂäü', 'success');
                            revenueForm.reset();
                            loadRevenueRecords();
                        } else {
                            showAlert('ÁáüÊî∂Ë®òÈåÑÊñ∞Â¢ûÂ§±Êïó', 'error');
                        }
                    } catch (error) {
                        showAlert('ÁáüÊî∂Ë®òÈåÑÊñ∞Â¢ûÂ§±Êïó: ' + error.message, 'error');
                    }
                });
            }
        });
        
        // ËºâÂÖ•ÁáüÊî∂Ë®òÈåÑ
        async function loadRevenueRecords() {
            // ÈÄôË£°ÂèØ‰ª•Âä†ËºâÂØ¶ÈöõÁöÑÁáüÊî∂Ë®òÈåÑÊï∏Êìö
            console.log('ËºâÂÖ•ÁáüÊî∂Ë®òÈåÑ...');
        }
        
        // Êü•ÁúãÁáüÊî∂Ë©≥ÊÉÖ
        function viewRevenueDetail(id) {
            showAlert(`Êü•ÁúãÁáüÊî∂Ë®òÈåÑ ID: ${id}`, 'info');
        }
        
        // ÂåØÂá∫ÁáüÊî∂Êï∏Êìö
        function exportRevenueData() {
            showAlert('Ê≠£Âú®ÂåØÂá∫ÁáüÊî∂Êï∏Êìö...', 'info');
        }
        
        // ==================== Á∂≠‰øÆÁõ∏ÈóúÂäüËÉΩ ====================
        
        // ËôïÁêÜÁ∂≠‰øÆË°®ÂñÆÊèê‰∫§
        document.addEventListener('DOMContentLoaded', function() {
            const maintenanceForm = document.getElementById('maintenance-form');
            if (maintenanceForm) {
                maintenanceForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    const formData = {
                        equipment_type: document.getElementById('equipment-type').value,
                        priority: document.getElementById('priority-level').value,
                        location: document.getElementById('equipment-location').value,
                        contact_phone: document.getElementById('contact-phone').value,
                        title: document.getElementById('maintenance-title').value,
                        description: document.getElementById('maintenance-description').value
                    };
                    
                    try {
                        const response = await fetch('/api/maintenance', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                                'Authorization': `Bearer ${localStorage.getItem('jwt_token')}`
                            },
                            body: JSON.stringify(formData)
                        });
                        
                        if (response.ok) {
                            showAlert('Á∂≠‰øÆÁî≥Ë´ãÂ∑≤Êèê‰∫§ÔºåÂ∞áÂú®24Â∞èÊôÇÂÖßËôïÁêÜ', 'success');
                            maintenanceForm.reset();
                            loadMaintenanceRecords();
                        } else {
                            showAlert('Á∂≠‰øÆÁî≥Ë´ãÊèê‰∫§Â§±Êïó', 'error');
                        }
                    } catch (error) {
                        showAlert('Á∂≠‰øÆÁî≥Ë´ãÊèê‰∫§Â§±Êïó: ' + error.message, 'error');
                    }
                });
                
                // Â≠óÊï∏Ë®àÊï∏Âô®
                const descriptionField = document.getElementById('maintenance-description');
                const charCount = document.getElementById('char-count');
                
                descriptionField.addEventListener('input', function() {
                    const remaining = 500 - this.value.length;
                    charCount.textContent = remaining;
                    charCount.className = remaining < 50 ? 'text-danger' : 'text-muted';
                });
            }
        });
        
        // ËºâÂÖ•Á∂≠‰øÆË®òÈåÑ
        async function loadMaintenanceRecords() {
            console.log('ËºâÂÖ•Á∂≠‰øÆË®òÈåÑ...');
        }
        
        // Êü•ÁúãÁ∂≠‰øÆË©≥ÊÉÖ
        function viewMaintenanceDetail(id) {
            showAlert(`Êü•ÁúãÁ∂≠‰øÆË©≥ÊÉÖ ID: ${id}`, 'info');
        }
        
        // ÂèñÊ∂àÁ∂≠‰øÆÁî≥Ë´ã
        function cancelMaintenance(id) {
            if (confirm('Á¢∫ÂÆöË¶ÅÂèñÊ∂àÈÄôÂÄãÁ∂≠‰øÆÁî≥Ë´ãÂóéÔºü')) {
                showAlert(`Á∂≠‰øÆÁî≥Ë´ã ${id} Â∑≤ÂèñÊ∂à`, 'info');
            }
        }
        
        // Á∂≠‰øÆÁãÄÊÖãÁØ©ÈÅ∏
        function filterMaintenanceStatus(status) {
            const rows = document.querySelectorAll('#maintenance-records tr');
            
            rows.forEach(row => {
                if (status === 'all' || row.dataset.status === status) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }
        
        // Á∂≠‰øÆË©ïÂàÜ
        function rateMaintenance(id) {
            showAlert(`Á∂≠‰øÆË©ïÂàÜÂäüËÉΩ ID: ${id}`, 'info');
        }
        
        // ==================== ÈÄöÁî®ÂäüËÉΩ ====================
        
        // È°ØÁ§∫Ê®°ÊÖãÊ°Ü
        function showModal(title, content, onConfirm) {
            const modalHtml = `
                <div class="modal fade" id="dynamicModal" tabindex="-1">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">${title}</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                ${content}
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ÂèñÊ∂à</button>
                                <button type="button" class="btn btn-primary" id="modal-confirm">Á¢∫Ë™ç</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHtml);
            
            const modal = new bootstrap.Modal(document.getElementById('dynamicModal'));
            
            document.getElementById('modal-confirm').addEventListener('click', async () => {
                if (onConfirm) {
                    await onConfirm();
                }
                modal.hide();
            });
            
            document.getElementById('dynamicModal').addEventListener('hidden.bs.modal', () => {
                document.getElementById('dynamicModal').remove();
            });
            
            modal.show();
        }
        
        // È°ØÁ§∫ÊèêÁ§∫Ë®äÊÅØ
        function showAlert(message, type = 'info') {
            const alertHtml = `
                <div class="alert alert-${type === 'error' ? 'danger' : type} alert-dismissible fade show position-fixed" 
                     style="top: 20px; right: 20px; z-index: 9999; max-width: 400px;">
                    ${message}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', alertHtml);
            
            // Ëá™ÂãïÊ∂àÂ§±
            setTimeout(() => {
                const alerts = document.querySelectorAll('.alert');
                if (alerts.length > 0) {
                    alerts[alerts.length - 1].remove();
                }
            }, 5000);
        }

        // Â∫´Â≠òÊü•Ë©¢ÂäüËÉΩ
        async function checkInventory() {
            try {
                const token = localStorage.getItem('token');
                
                // ÂâµÂª∫Ê®°ÊÖãÊ°Ü
                const modalHtml = `
                    <div class="modal fade" id="inventoryModal" tabindex="-1">
                        <div class="modal-dialog modal-lg">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title">
                                        <i class="fas fa-boxes me-2"></i>Â∫´Â≠òÊü•Ë©¢
                                    </h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                </div>
                                <div class="modal-body">
                                    <div class="text-center py-4">
                                        <div class="spinner-border text-primary" role="status">
                                            <span class="visually-hidden">ËºâÂÖ•‰∏≠...</span>
                                        </div>
                                        <p class="mt-2">Ê≠£Âú®ËºâÂÖ•Â∫´Â≠òË≥áÊñô...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                document.body.insertAdjacentHTML('beforeend', modalHtml);
                const modal = new bootstrap.Modal(document.getElementById('inventoryModal'));
                modal.show();
                
                // Áç≤ÂèñÂïÜÂìÅÂ∫´Â≠ò
                const [productsResponse, lowStockResponse] = await Promise.all([
                    fetch('/api/products', {
                        headers: { 'Authorization': `Bearer ${token}` }
                    }),
                    fetch('/api/products/low-stock', {
                        headers: { 'Authorization': `Bearer ${token}` }
                    })
                ]);
                
                const productsResult = await productsResponse.json();
                const lowStockResult = await lowStockResponse.json();
                
                if (productsResult.success) {
                    const products = productsResult.data;
                    const lowStockProducts = lowStockResult.success ? lowStockResult.data : [];
                    
                    // Êõ¥Êñ∞Ê®°ÊÖãÊ°ÜÂÖßÂÆπ
                    document.querySelector('#inventoryModal .modal-body').innerHTML = `
                        ${lowStockProducts.length > 0 ? `
                            <div class="alert alert-warning">
                                <h6><i class="fas fa-exclamation-triangle me-2"></i>‰ΩéÂ∫´Â≠òË≠¶Âëä</h6>
                                ${lowStockProducts.map(p => 
                                    `<div class="small">‚Ä¢ ${p.name}ÔºöÂâ©È§ò ${p.current_stock} ${p.unit} (Ë≠¶ÊàíÂÄºÔºö${p.min_threshold})</div>`
                                ).join('')}
                            </div>
                        ` : ''}
                        
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>ÂïÜÂìÅÂêçÁ®±</th>
                                        <th>ÂàÜÈ°û</th>
                                        <th>ÁõÆÂâçÂ∫´Â≠ò</th>
                                        <th>Ë≠¶ÊàíÂÄº</th>
                                        <th>ÁãÄÊÖã</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${products.map(product => {
                                        const stockStatus = product.current_stock <= 0 ? 
                                            '<span class="badge bg-danger">Áº∫Ë≤®</span>' :
                                            product.current_stock <= product.min_threshold ?
                                            '<span class="badge bg-warning">‰ΩéÂ∫´Â≠ò</span>' :
                                            '<span class="badge bg-success">Ê≠£Â∏∏</span>';
                                        
                                        return `
                                            <tr>
                                                <td>${product.name}</td>
                                                <td><span class="badge bg-secondary">${product.category}</span></td>
                                                <td>${product.current_stock} ${product.unit}</td>
                                                <td>${product.min_threshold} ${product.unit}</td>
                                                <td>${stockStatus}</td>
                                            </tr>
                                        `;
                                    }).join('')}
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="text-center mt-3">
                            <button class="btn btn-primary" onclick="window.location.href='/ordering.html'">
                                <i class="fas fa-shopping-cart me-2"></i>ÂâçÂæÄÂè´Ë≤®Á≥ªÁµ±
                            </button>
                        </div>
                    `;
                } else {
                    document.querySelector('#inventoryModal .modal-body').innerHTML = `
                        <div class="alert alert-danger">
                            <i class="fas fa-exclamation-circle me-2"></i>
                            ËºâÂÖ•Â∫´Â≠òË≥áÊñôÂ§±ÊïóÔºö${productsResult.message}
                        </div>
                    `;
                }
                
                // Ê®°ÊÖãÊ°ÜÈóúÈñâÊôÇÁßªÈô§ÂÖÉÁ¥†
                document.getElementById('inventoryModal').addEventListener('hidden.bs.modal', function() {
                    this.remove();
                });
                
            } catch (error) {
                console.error('Â∫´Â≠òÊü•Ë©¢Â§±Êïó:', error);
                showAlert('Â∫´Â≠òÊü•Ë©¢Â§±ÊïóÔºö' + error.message, 'error');
            }
        }
        
        // ‰øÆÊîπÂØÜÁ¢º
        function changePassword() {
            const oldPassword = document.getElementById('old-password').value;
            const newPassword = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;
            
            if (!oldPassword || !newPassword || !confirmPassword) {
                showAlert('Ë´ãÂ°´ÂØ´ÂÆåÊï¥ÁöÑÂØÜÁ¢ºË≥áÊñô', 'error');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                showAlert('Êñ∞ÂØÜÁ¢ºÁ¢∫Ë™ç‰∏ç‰∏ÄËá¥', 'error');
                return;
            }
            
            showAlert('ÂØÜÁ¢º‰øÆÊîπÊàêÂäü', 'success');
        }

        // ÁôªÂá∫
        function logout() {
            localStorage.removeItem('jwt_token');
            localStorage.removeItem('user_data');
            window.location.href = '/login.html';
        }

        // È†ÅÈù¢ËºâÂÖ•ÊôÇÂü∑Ë°å
        document.addEventListener('DOMContentLoaded', function() {
            if (checkEmployeeAuth()) {
                loadDashboard();
            }
        });
    </script>
</body>
</html>