<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GClaude ä¼æ¥­ç®¡ç†ç³»çµ± - å“¡å·¥å·¥ä½œå°</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-info">
        <div class="container-fluid">
            <a class="navbar-brand" href="#"><i class="fas fa-user me-2"></i>å“¡å·¥å·¥ä½œå°</a>
            <div class="navbar-nav ms-auto">
                <span class="navbar-text me-3">æ­¡è¿ï¼Œ<span id="employee-name">å“¡å·¥</span></span>
                <button class="btn btn-outline-light btn-sm" onclick="logout()">ç™»å‡º</button>
            </div>
        </div>
    </nav>

    <div class="container-fluid mt-4">
        <div class="row">
            <!-- å´é‚Šæ¬„ -->
            <div class="col-md-3 col-lg-2">
                <div class="list-group">
                    <a href="#dashboard" class="list-group-item list-group-item-action active" onclick="showSection('dashboard')">
                        <i class="fas fa-home me-2"></i>æˆ‘çš„é¦–é 
                    </a>
                    <a href="#attendance" class="list-group-item list-group-item-action" onclick="showSection('attendance')">
                        <i class="fas fa-clock me-2"></i>æ‰“å¡ç°½åˆ°
                    </a>
                    <a href="#schedule" class="list-group-item list-group-item-action" onclick="showSection('schedule')">
                        <i class="fas fa-calendar me-2"></i>æˆ‘çš„ç­è¡¨
                    </a>
                    <a href="#revenue" class="list-group-item list-group-item-action" onclick="showSection('revenue')">
                        <i class="fas fa-cash-register me-2"></i>ç‡Ÿæ”¶ç™»è¨˜
                    </a>
                    <a href="#maintenance" class="list-group-item list-group-item-action" onclick="showSection('maintenance')">
                        <i class="fas fa-tools me-2"></i>ç¶­ä¿®ç”³è«‹
                    </a>
                    <a href="#profile" class="list-group-item list-group-item-action" onclick="showSection('profile')">
                        <i class="fas fa-user-cog me-2"></i>å€‹äººè³‡æ–™
                    </a>
                </div>
            </div>

            <!-- ä¸»è¦å…§å®¹ -->
            <div class="col-md-9 col-lg-10">
                <!-- æˆ‘çš„é¦–é  -->
                <div id="dashboard-section" class="content-section">
                    <h2><i class="fas fa-home me-2"></i>æˆ‘çš„å·¥ä½œå°</h2>
                    
                    <!-- å¿«é€Ÿæ“ä½œ -->
                    <div class="row mb-4">
                        <div class="col-md-6 col-lg-3 mb-3">
                            <div class="card bg-success text-white h-100">
                                <div class="card-body text-center">
                                    <i class="fas fa-sign-in-alt fa-2x mb-2"></i>
                                    <h5>ä¸Šç­æ‰“å¡</h5>
                                    <button class="btn btn-light btn-sm" onclick="clockIn()">ç«‹å³æ‰“å¡</button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-3 mb-3">
                            <div class="card bg-danger text-white h-100">
                                <div class="card-body text-center">
                                    <i class="fas fa-sign-out-alt fa-2x mb-2"></i>
                                    <h5>ä¸‹ç­æ‰“å¡</h5>
                                    <button class="btn btn-light btn-sm" onclick="clockOut()">ç«‹å³æ‰“å¡</button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-3 mb-3">
                            <div class="card bg-primary text-white h-100">
                                <div class="card-body text-center">
                                    <i class="fas fa-dollar-sign fa-2x mb-2"></i>
                                    <h5>ç‡Ÿæ”¶ç™»è¨˜</h5>
                                    <button class="btn btn-light btn-sm" onclick="showSection('revenue')">å‰å¾€ç™»è¨˜</button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-3 mb-3">
                            <div class="card bg-warning text-white h-100">
                                <div class="card-body text-center">
                                    <i class="fas fa-wrench fa-2x mb-2"></i>
                                    <h5>ç¶­ä¿®ç”³è«‹</h5>
                                    <button class="btn btn-light btn-sm" onclick="showSection('maintenance')">å‰å¾€ç”³è«‹</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ä»Šæ—¥çµ±è¨ˆ -->
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <div class="card">
                                <div class="card-header">
                                    <h6><i class="fas fa-clock me-1"></i>ä»Šæ—¥å‡ºå‹¤</h6>
                                </div>
                                <div class="card-body">
                                    <p class="mb-1">ä¸Šç­æ™‚é–“: <span id="clock-in-time">--:--</span></p>
                                    <p class="mb-1">ä¸‹ç­æ™‚é–“: <span id="clock-out-time">--:--</span></p>
                                    <p class="mb-0">å·¥ä½œæ™‚æ•¸: <span id="work-hours">--</span></p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <div class="card">
                                <div class="card-header">
                                    <h6><i class="fas fa-calendar me-1"></i>æœ¬æœˆçµ±è¨ˆ</h6>
                                </div>
                                <div class="card-body">
                                    <p class="mb-1">å‡ºå‹¤å¤©æ•¸: <span id="month-days">--</span></p>
                                    <p class="mb-1">ç¸½å·¥æ™‚: <span id="month-hours">--</span></p>
                                    <p class="mb-0">é²åˆ°æ¬¡æ•¸: <span id="late-count">--</span></p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <div class="card">
                                <div class="card-header">
                                    <h6><i class="fas fa-bell me-1"></i>ç³»çµ±é€šçŸ¥</h6>
                                </div>
                                <div class="card-body">
                                    <div id="notifications">
                                        <p class="text-muted">ç„¡æ–°é€šçŸ¥</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- æ‰“å¡ç°½åˆ° -->
                <div id="attendance-section" class="content-section d-none">
                    <h2><i class="fas fa-clock me-2"></i>å‡ºå‹¤æ‰“å¡</h2>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h5>GPS æ‰“å¡</h5>
                                </div>
                                <div class="card-body text-center">
                                    <div id="current-time" class="h3 text-primary mb-3"></div>
                                    <div id="location-status" class="mb-3">
                                        <i class="fas fa-spinner fa-spin"></i> æ­£åœ¨å®šä½...
                                    </div>
                                    <div class="btn-group" role="group">
                                        <button id="clock-in-btn" class="btn btn-success btn-lg" onclick="clockIn()">
                                            <i class="fas fa-sign-in-alt me-1"></i>ä¸Šç­æ‰“å¡
                                        </button>
                                        <button id="clock-out-btn" class="btn btn-danger btn-lg" onclick="clockOut()">
                                            <i class="fas fa-sign-out-alt me-1"></i>ä¸‹ç­æ‰“å¡
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h5>æœ€è¿‘æ‰“å¡è¨˜éŒ„</h5>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-sm">
                                            <thead>
                                                <tr>
                                                    <th>æ—¥æœŸ</th>
                                                    <th>ä¸Šç­</th>
                                                    <th>ä¸‹ç­</th>
                                                    <th>ç‹€æ…‹</th>
                                                </tr>
                                            </thead>
                                            <tbody id="attendance-history">
                                                <tr>
                                                    <td colspan="4" class="text-center">è¼‰å…¥ä¸­...</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- æˆ‘çš„ç­è¡¨ -->
                <div id="schedule-section" class="content-section d-none">
                    <h2><i class="fas fa-calendar me-2"></i>æˆ‘çš„ç­è¡¨</h2>
                    
                    <!-- ç­è¡¨æ§åˆ¶ -->
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <div class="btn-group" role="group">
                                <button class="btn btn-primary" onclick="showWeekSchedule()">æœ¬é€±ç­è¡¨</button>
                                <button class="btn btn-outline-primary" onclick="showMonthSchedule()">æœ¬æœˆç­è¡¨</button>
                            </div>
                        </div>
                        <div class="col-md-6 text-end">
                            <button class="btn btn-success" onclick="requestLeave()"><i class="fas fa-calendar-times me-1"></i>è«‹å‡ç”³è«‹</button>
                        </div>
                    </div>
                    
                    <!-- æœ¬é€±ç­è¡¨ -->
                    <div id="week-schedule" class="card">
                        <div class="card-header">
                            <h5><i class="fas fa-calendar-week me-1"></i>æœ¬é€±ç­è¡¨ (2025å¹´8æœˆ11æ—¥ - 8æœˆ17æ—¥)</h5>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-bordered text-center">
                                    <thead class="table-primary">
                                        <tr>
                                            <th>æ™‚æ®µ</th>
                                            <th>é€±ä¸€<br><small>8/11</small></th>
                                            <th>é€±äºŒ<br><small>8/12</small></th>
                                            <th>é€±ä¸‰<br><small>8/13</small></th>
                                            <th>é€±å››<br><small>8/14</small></th>
                                            <th>é€±äº”<br><small>8/15</small></th>
                                            <th>é€±å…­<br><small>8/16</small></th>
                                            <th>é€±æ—¥<br><small>8/17</small></th>
                                        </tr>
                                    </thead>
                                    <tbody id="week-schedule-body">
                                        <tr>
                                            <td class="table-secondary"><strong>æ—©ç­<br>09:00-17:00</strong></td>
                                            <td class="bg-success text-white">âœ“ æ­£ç­</td>
                                            <td class="bg-success text-white">âœ“ æ­£ç­</td>
                                            <td class="bg-success text-white">âœ“ æ­£ç­</td>
                                            <td class="bg-success text-white">âœ“ æ­£ç­</td>
                                            <td class="bg-success text-white">âœ“ æ­£ç­</td>
                                            <td class="bg-secondary text-white">ä¼‘å‡</td>
                                            <td class="bg-secondary text-white">ä¼‘å‡</td>
                                        </tr>
                                        <tr>
                                            <td class="table-secondary"><strong>æ™šç­<br>14:00-22:00</strong></td>
                                            <td class="bg-light">-</td>
                                            <td class="bg-light">-</td>
                                            <td class="bg-light">-</td>
                                            <td class="bg-light">-</td>
                                            <td class="bg-light">-</td>
                                            <td class="bg-light">-</td>
                                            <td class="bg-light">-</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    
                    <!-- æœ¬æœˆç­è¡¨æ‘˜è¦ -->
                    <div id="month-schedule" class="card d-none">
                        <div class="card-header">
                            <h5><i class="fas fa-calendar-alt me-1"></i>æœ¬æœˆç­è¡¨æ‘˜è¦ (2025å¹´8æœˆ)</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="text-center p-3 border rounded">
                                        <h4 class="text-primary">22</h4>
                                        <p class="mb-0">å·¥ä½œå¤©æ•¸</p>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="text-center p-3 border rounded">
                                        <h4 class="text-success">176</h4>
                                        <p class="mb-0">é è¨ˆå·¥æ™‚</p>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="text-center p-3 border rounded">
                                        <h4 class="text-warning">8</h4>
                                        <p class="mb-0">ä¼‘å‡å¤©æ•¸</p>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="text-center p-3 border rounded">
                                        <h4 class="text-info">2</h4>
                                        <p class="mb-0">åŠ ç­å¤©æ•¸</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- è«‹å‡è¨˜éŒ„ -->
                    <div class="card mt-3">
                        <div class="card-header">
                            <h6><i class="fas fa-history me-1"></i>æœ€è¿‘è«‹å‡è¨˜éŒ„</h6>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-sm">
                                    <thead>
                                        <tr>
                                            <th>ç”³è«‹æ—¥æœŸ</th>
                                            <th>è«‹å‡é¡å‹</th>
                                            <th>è«‹å‡æ—¥æœŸ</th>
                                            <th>å¤©æ•¸</th>
                                            <th>ç‹€æ…‹</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>2025-08-10</td>
                                            <td>å¹´å‡</td>
                                            <td>2025-08-16</td>
                                            <td>1å¤©</td>
                                            <td><span class="badge bg-success">å·²æ ¸å‡†</span></td>
                                        </tr>
                                        <tr>
                                            <td>2025-08-05</td>
                                            <td>ç—…å‡</td>
                                            <td>2025-08-07</td>
                                            <td>0.5å¤©</td>
                                            <td><span class="badge bg-success">å·²æ ¸å‡†</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ç‡Ÿæ”¶ç™»è¨˜ -->
                <div id="revenue-section" class="content-section d-none">
                    <h2><i class="fas fa-cash-register me-2"></i>ç‡Ÿæ”¶ç™»è¨˜</h2>
                    
                    <!-- å¿«é€Ÿç™»è¨˜ -->
                    <div class="row mb-4">
                        <div class="col-md-8">
                            <div class="card">
                                <div class="card-header">
                                    <h5><i class="fas fa-plus me-1"></i>æ–°å¢ç‡Ÿæ”¶è¨˜éŒ„</h5>
                                </div>
                                <div class="card-body">
                                    <form id="revenue-form">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label class="form-label">ç‡Ÿæ”¶é¡åˆ¥</label>
                                                    <select class="form-select" id="revenue-category" required>
                                                        <option value="">è«‹é¸æ“‡é¡åˆ¥</option>
                                                        <option value="product_sales">ç”¢å“éŠ·å”®</option>
                                                        <option value="service_income">æœå‹™æ”¶å…¥</option>
                                                        <option value="maintenance_fee">ç¶­è­·è²»ç”¨</option>
                                                        <option value="consultation">è«®è©¢è²»ç”¨</option>
                                                        <option value="other">å…¶ä»–</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label class="form-label">é …ç›®åç¨±</label>
                                                    <input type="text" class="form-control" id="revenue-item" placeholder="è¼¸å…¥é …ç›®åç¨±" required>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label class="form-label">é‡‘é¡ (NT$)</label>
                                                    <input type="number" class="form-control" id="revenue-amount" placeholder="0" min="0" step="1" required>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label class="form-label">å®¢æˆ¶å§“å</label>
                                                    <input type="text" class="form-control" id="revenue-customer" placeholder="å®¢æˆ¶å§“å" required>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">å‚™è¨»</label>
                                            <textarea class="form-control" id="revenue-notes" rows="2" placeholder="ç‡Ÿæ”¶è©³ç´°èªªæ˜..." maxlength="200"></textarea>
                                        </div>
                                        <div class="d-grid">
                                            <button type="submit" class="btn btn-primary"><i class="fas fa-save me-1"></i>å„²å­˜ç‡Ÿæ”¶è¨˜éŒ„</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-header">
                                    <h6><i class="fas fa-chart-pie me-1"></i>ä»Šæ—¥ç‡Ÿæ”¶çµ±è¨ˆ</h6>
                                </div>
                                <div class="card-body text-center">
                                    <h3 class="text-success" id="today-revenue-total">NT$ 45,800</h3>
                                    <p class="text-muted mb-2">ä»Šæ—¥ç¸½ç‡Ÿæ”¶</p>
                                    <hr>
                                    <div class="d-flex justify-content-between">
                                        <small>ç”¢å“éŠ·å”®:</small>
                                        <small class="text-success">NT$ 32,000</small>
                                    </div>
                                    <div class="d-flex justify-content-between">
                                        <small>æœå‹™æ”¶å…¥:</small>
                                        <small class="text-info">NT$ 8,500</small>
                                    </div>
                                    <div class="d-flex justify-content-between">
                                        <small>å…¶ä»–:</small>
                                        <small class="text-warning">NT$ 5,300</small>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card mt-3">
                                <div class="card-header">
                                    <h6><i class="fas fa-target me-1"></i>æœ¬æœˆç›®æ¨™</h6>
                                </div>
                                <div class="card-body">
                                    <div class="progress mb-2">
                                        <div class="progress-bar bg-success" style="width: 68%"></div>
                                    </div>
                                    <div class="d-flex justify-content-between">
                                        <small>å·²é”æˆ: 68%</small>
                                        <small>ç›®æ¨™: NT$ 500,000</small>
                                    </div>
                                    <p class="mt-2 mb-0"><strong>ç›®å‰: NT$ 340,000</strong></p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- æœ€è¿‘è¨˜éŒ„ -->
                    <div class="card">
                        <div class="card-header">
                            <h5><i class="fas fa-list me-1"></i>æˆ‘çš„ç‡Ÿæ”¶è¨˜éŒ„</h5>
                            <button class="btn btn-sm btn-outline-secondary float-end" onclick="exportRevenueData()"><i class="fas fa-download me-1"></i>åŒ¯å‡º</button>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-striped">
                                    <thead>
                                        <tr>
                                            <th>æ—¥æœŸæ™‚é–“</th>
                                            <th>é¡åˆ¥</th>
                                            <th>é …ç›®</th>
                                            <th>å®¢æˆ¶</th>
                                            <th>é‡‘é¡</th>
                                            <th>ç‹€æ…‹</th>
                                            <th>æ“ä½œ</th>
                                        </tr>
                                    </thead>
                                    <tbody id="revenue-records">
                                        <tr>
                                            <td>2025-08-15 14:30</td>
                                            <td><span class="badge bg-primary">ç”¢å“éŠ·å”®</span></td>
                                            <td>Aç´šç”¢å“å¥—çµ„</td>
                                            <td>å¼µå…ˆç”Ÿ</td>
                                            <td class="text-success">NT$ 15,000</td>
                                            <td><span class="badge bg-success">å·²ç¢ºèª</span></td>
                                            <td>
                                                <button class="btn btn-sm btn-outline-info" onclick="viewRevenueDetail(1)"><i class="fas fa-eye"></i></button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>2025-08-15 11:15</td>
                                            <td><span class="badge bg-info">æœå‹™æ”¶å…¥</span></td>
                                            <td>ç³»çµ±ç¶­è­·</td>
                                            <td>æå°å§</td>
                                            <td class="text-success">NT$ 8,500</td>
                                            <td><span class="badge bg-warning">å¾…ç¢ºèª</span></td>
                                            <td>
                                                <button class="btn btn-sm btn-outline-info" onclick="viewRevenueDetail(2)"><i class="fas fa-eye"></i></button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>2025-08-15 09:45</td>
                                            <td><span class="badge bg-success">è«®è©¢è²»ç”¨</span></td>
                                            <td>å°ˆæ¥­è«®è©¢</td>
                                            <td>ç‹ç¶“ç†</td>
                                            <td class="text-success">NT$ 5,300</td>
                                            <td><span class="badge bg-success">å·²ç¢ºèª</span></td>
                                            <td>
                                                <button class="btn btn-sm btn-outline-info" onclick="viewRevenueDetail(3)"><i class="fas fa-eye"></i></button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ç¶­ä¿®ç”³è«‹ -->
                <div id="maintenance-section" class="content-section d-none">
                    <h2><i class="fas fa-tools me-2"></i>ç¶­ä¿®ç”³è«‹</h2>
                    
                    <!-- æ–°å¢ç”³è«‹ -->
                    <div class="row mb-4">
                        <div class="col-md-8">
                            <div class="card">
                                <div class="card-header">
                                    <h5><i class="fas fa-plus me-1"></i>æäº¤ç¶­ä¿®ç”³è«‹</h5>
                                </div>
                                <div class="card-body">
                                    <form id="maintenance-form">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label class="form-label">è¨­å‚™é¡å‹</label>
                                                    <select class="form-select" id="equipment-type" required>
                                                        <option value="">è«‹é¸æ“‡è¨­å‚™</option>
                                                        <option value="computer">é›»è…¦è¨­å‚™</option>
                                                        <option value="printer">å°è¡¨æ©Ÿ</option>
                                                        <option value="air_conditioning">ç©ºèª¿ç³»çµ±</option>
                                                        <option value="lighting">ç…§æ˜è¨­å‚™</option>
                                                        <option value="network">ç¶²è·¯è¨­å‚™</option>
                                                        <option value="furniture">è¾¦å…¬å®¶å…·</option>
                                                        <option value="security">å®‰å…¨è¨­å‚™</option>
                                                        <option value="other">å…¶ä»–</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label class="form-label">ç·Šæ€¥ç¨‹åº¦</label>
                                                    <select class="form-select" id="priority-level" required>
                                                        <option value="">è«‹é¸æ“‡ç¨‹åº¦</option>
                                                        <option value="low">ğŸŸ¢ ä½ - ä¸å½±éŸ¿å·¥ä½œ</option>
                                                        <option value="medium">ğŸŸ¡ ä¸­ - ç¨å¾®å½±éŸ¿</option>
                                                        <option value="high">ğŸ”´ é«˜ - åš´é‡å½±éŸ¿</option>
                                                        <option value="urgent">âš¡ ç·Šæ€¥ - ç„¡æ³•å·¥ä½œ</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label class="form-label">è¨­å‚™ä½ç½®</label>
                                                    <input type="text" class="form-control" id="equipment-location" placeholder="ä¾‹ï¼š3æ¨“æœƒè­°å®¤" required>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label class="form-label">è¯çµ¡é›»è©±</label>
                                                    <input type="tel" class="form-control" id="contact-phone" placeholder="åˆ†æ©Ÿæˆ–æ‰‹æ©Ÿ" required>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">å•é¡Œæ¨™é¡Œ</label>
                                            <input type="text" class="form-control" id="maintenance-title" placeholder="ç°¡è¿°å•é¡Œ" maxlength="100" required>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">è©³ç´°æè¿°</label>
                                            <textarea class="form-control" id="maintenance-description" rows="4" placeholder="è«‹è©³ç´°æè¿°å•é¡Œç‹€æ³ã€ç™¼ç”Ÿæ™‚é–“ã€å½±éŸ¿ç¯„åœç­‰..." maxlength="500" required></textarea>
                                            <div class="form-text">å‰©é¤˜å­—æ•¸: <span id="char-count">500</span></div>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">é™„åŠ ç…§ç‰‡ (é¸å¡«)</label>
                                            <input type="file" class="form-control" id="maintenance-photos" accept="image/*" multiple>
                                            <div class="form-text">å¯ä¸Šå‚³å¤šå¼µç…§ç‰‡ï¼Œæ”¯æ´ JPG, PNG æ ¼å¼</div>
                                        </div>
                                        <div class="d-grid">
                                            <button type="submit" class="btn btn-danger"><i class="fas fa-paper-plane me-1"></i>æäº¤ç¶­ä¿®ç”³è«‹</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-header">
                                    <h6><i class="fas fa-info-circle me-1"></i>ç”³è«‹é ˆçŸ¥</h6>
                                </div>
                                <div class="card-body">
                                    <div class="alert alert-info">
                                        <h6><i class="fas fa-clock me-1"></i>è™•ç†æ™‚é–“</h6>
                                        <ul class="mb-0">
                                            <li>ğŸŸ¢ ä½: 3-5å€‹å·¥ä½œå¤©</li>
                                            <li>ğŸŸ¡ ä¸­: 1-2å€‹å·¥ä½œå¤©</li>
                                            <li>ğŸ”´ é«˜: 4-8å°æ™‚</li>
                                            <li>âš¡ ç·Šæ€¥: ç«‹å³è™•ç†</li>
                                        </ul>
                                    </div>
                                    <div class="alert alert-warning">
                                        <h6><i class="fas fa-exclamation-triangle me-1"></i>æ³¨æ„äº‹é …</h6>
                                        <ul class="mb-0">
                                            <li>è«‹æº–ç¢ºå¡«å¯«è¨­å‚™ä½ç½®</li>
                                            <li>è©³ç´°æè¿°æœ‰åŠ©å¿«é€Ÿæ’é™¤</li>
                                            <li>ç·Šæ€¥æƒ…æ³è«‹åŒæ™‚é›»è©±è¯ç¹«</li>
                                            <li>ç…§ç‰‡æœ‰åŠ©æ–¼å•é¡Œåˆ¤æ–·</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- æˆ‘çš„ç”³è«‹è¨˜éŒ„ -->
                    <div class="card">
                        <div class="card-header">
                            <h5><i class="fas fa-history me-1"></i>æˆ‘çš„ç”³è«‹è¨˜éŒ„</h5>
                            <div class="btn-group btn-group-sm float-end" role="group">
                                <button class="btn btn-outline-secondary" onclick="filterMaintenanceStatus('all')">å…¨éƒ¨</button>
                                <button class="btn btn-outline-warning" onclick="filterMaintenanceStatus('pending')">å¾…è™•ç†</button>
                                <button class="btn btn-outline-primary" onclick="filterMaintenanceStatus('in_progress')">è™•ç†ä¸­</button>
                                <button class="btn btn-outline-success" onclick="filterMaintenanceStatus('completed')">å·²å®Œæˆ</button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-striped">
                                    <thead>
                                        <tr>
                                            <th>ç”³è«‹æ™‚é–“</th>
                                            <th>è¨­å‚™é¡å‹</th>
                                            <th>å•é¡Œæ¨™é¡Œ</th>
                                            <th>ä½ç½®</th>
                                            <th>ç·Šæ€¥ç¨‹åº¦</th>
                                            <th>ç‹€æ…‹</th>
                                            <th>è™•ç†äººå“¡</th>
                                            <th>æ“ä½œ</th>
                                        </tr>
                                    </thead>
                                    <tbody id="maintenance-records">
                                        <tr data-status="pending">
                                            <td>2025-08-15 09:15</td>
                                            <td><i class="fas fa-snowflake text-info"></i> ç©ºèª¿ç³»çµ±</td>
                                            <td>ä¸‰æ¨“æœƒè­°å®¤ç©ºèª¿ä¸å†·</td>
                                            <td>3F-æœƒè­°å®¤A</td>
                                            <td><span class="badge bg-danger">ğŸ”´ é«˜</span></td>
                                            <td><span class="badge bg-warning">å¾…è™•ç†</span></td>
                                            <td>-</td>
                                            <td>
                                                <button class="btn btn-sm btn-outline-info" onclick="viewMaintenanceDetail(1)"><i class="fas fa-eye"></i></button>
                                                <button class="btn btn-sm btn-outline-danger" onclick="cancelMaintenance(1)"><i class="fas fa-times"></i></button>
                                            </td>
                                        </tr>
                                        <tr data-status="in_progress">
                                            <td>2025-08-14 14:30</td>
                                            <td><i class="fas fa-print text-secondary"></i> å°è¡¨æ©Ÿ</td>
                                            <td>äºŒæ¨“å°è¡¨æ©Ÿç¶“å¸¸å¡ç´™</td>
                                            <td>2F-è¾¦å…¬å€</td>
                                            <td><span class="badge bg-warning">ğŸŸ¡ ä¸­</span></td>
                                            <td><span class="badge bg-primary">è™•ç†ä¸­</span></td>
                                            <td>ç¶­ä¿®éƒ¨-å°ç‹</td>
                                            <td>
                                                <button class="btn btn-sm btn-outline-info" onclick="viewMaintenanceDetail(2)"><i class="fas fa-eye"></i></button>
                                            </td>
                                        </tr>
                                        <tr data-status="completed">
                                            <td>2025-08-13 16:45</td>
                                            <td><i class="fas fa-lightbulb text-warning"></i> ç…§æ˜è¨­å‚™</td>
                                            <td>è¾¦å…¬å®¤æ—¥å…‰ç‡ˆé–ƒçˆ</td>
                                            <td>1F-è²¡å‹™éƒ¨</td>
                                            <td><span class="badge bg-success">ğŸŸ¢ ä½</span></td>
                                            <td><span class="badge bg-success">å·²å®Œæˆ</span></td>
                                            <td>é›»å·¥-è€æ</td>
                                            <td>
                                                <button class="btn btn-sm btn-outline-info" onclick="viewMaintenanceDetail(3)"><i class="fas fa-eye"></i></button>
                                                <button class="btn btn-sm btn-outline-success" onclick="rateMaintenance(3)"><i class="fas fa-star"></i></button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- å€‹äººè³‡æ–™ -->
                <div id="profile-section" class="content-section d-none">
                    <h2><i class="fas fa-user-cog me-2"></i>å€‹äººè³‡æ–™</h2>
                    <div class="card">
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <h5>åŸºæœ¬è³‡æ–™</h5>
                                    <table class="table table-borderless">
                                        <tr><th>å§“å:</th><td id="profile-name">--</td></tr>
                                        <tr><th>å“¡å·¥ç·¨è™Ÿ:</th><td id="profile-id">--</td></tr>
                                        <tr><th>è·ä½:</th><td id="profile-role">--</td></tr>
                                        <tr><th>éƒ¨é–€:</th><td id="profile-department">--</td></tr>
                                        <tr><th>é›»è©±:</th><td id="profile-phone">--</td></tr>
                                        <tr><th>ä¿¡ç®±:</th><td id="profile-email">--</td></tr>
                                    </table>
                                </div>
                                <div class="col-md-6">
                                    <h5>ä¿®æ”¹å¯†ç¢¼</h5>
                                    <div class="mb-3">
                                        <label class="form-label">èˆŠå¯†ç¢¼</label>
                                        <input type="password" class="form-control" id="old-password">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">æ–°å¯†ç¢¼</label>
                                        <input type="password" class="form-control" id="new-password">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">ç¢ºèªæ–°å¯†ç¢¼</label>
                                        <input type="password" class="form-control" id="confirm-password">
                                    </div>
                                    <button class="btn btn-primary" onclick="changePassword()">ä¿®æ”¹å¯†ç¢¼</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // æª¢æŸ¥å“¡å·¥æ¬Šé™
        function checkEmployeeAuth() {
            const token = localStorage.getItem('jwt_token');
            const user = JSON.parse(localStorage.getItem('user_data') || '{}');
            
            if (!token || !user) {
                alert('è«‹å…ˆç™»å…¥');
                window.location.href = '/login.html';
                return false;
            }
            
            document.getElementById('employee-name').textContent = user.name;
            return true;
        }

        // é¡¯ç¤ºæŒ‡å®šå€å¡Š
        function showSection(sectionName) {
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.add('d-none');
            });
            
            document.querySelectorAll('.list-group-item').forEach(item => {
                item.classList.remove('active');
            });
            
            document.getElementById(sectionName + '-section').classList.remove('d-none');
            document.querySelector(`[onclick="showSection('${sectionName}')"]`).classList.add('active');
            
            if (sectionName === 'dashboard') loadDashboard();
            if (sectionName === 'attendance') loadAttendance();
            if (sectionName === 'profile') loadProfile();
        }

        // è¼‰å…¥é¦–é æ•¸æ“š
        async function loadDashboard() {
            const token = localStorage.getItem('jwt_token');
            
            try {
                // è¼‰å…¥ä»Šæ—¥å‡ºå‹¤
                const response = await fetch('/api/attendance/today', {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                
                if (response.ok) {
                    const attendance = await response.json();
                    document.getElementById('clock-in-time').textContent = 
                        attendance.clock_in ? new Date(attendance.clock_in).toLocaleTimeString() : '--:--';
                    document.getElementById('clock-out-time').textContent = 
                        attendance.clock_out ? new Date(attendance.clock_out).toLocaleTimeString() : '--:--';
                    
                    if (attendance.clock_in && attendance.clock_out) {
                        const hours = (new Date(attendance.clock_out) - new Date(attendance.clock_in)) / (1000 * 60 * 60);
                        document.getElementById('work-hours').textContent = hours.toFixed(1) + ' å°æ™‚';
                    }
                }
            } catch (error) {
                console.error('è¼‰å…¥é¦–é æ•¸æ“šå¤±æ•—:', error);
            }
        }

        // è¼‰å…¥å‡ºå‹¤é é¢
        function loadAttendance() {
            updateCurrentTime();
            getCurrentLocation();
            loadAttendanceHistory();
            
            // æ¯ç§’æ›´æ–°æ™‚é–“
            setInterval(updateCurrentTime, 1000);
        }

        // è¼‰å…¥å€‹äººè³‡æ–™
        function loadProfile() {
            const user = JSON.parse(localStorage.getItem('user_data') || '{}');
            
            document.getElementById('profile-name').textContent = user.name || '--';
            document.getElementById('profile-id').textContent = user.employee_id || '--';
            document.getElementById('profile-role').textContent = user.role || '--';
            document.getElementById('profile-department').textContent = user.department_name || '--';
            document.getElementById('profile-phone').textContent = user.phone || '--';
            document.getElementById('profile-email').textContent = user.email || '--';
        }

        // æ›´æ–°ç•¶å‰æ™‚é–“
        function updateCurrentTime() {
            const now = new Date();
            document.getElementById('current-time').textContent = now.toLocaleTimeString('zh-TW');
        }

        // ç²å–ç•¶å‰ä½ç½®
        function getCurrentLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    function(position) {
                        document.getElementById('location-status').innerHTML = 
                            '<i class="fas fa-map-marker-alt text-success"></i> å®šä½æˆåŠŸ';
                    },
                    function(error) {
                        document.getElementById('location-status').innerHTML = 
                            '<i class="fas fa-exclamation-triangle text-warning"></i> å®šä½å¤±æ•—';
                    }
                );
            } else {
                document.getElementById('location-status').innerHTML = 
                    '<i class="fas fa-times text-danger"></i> ä¸æ”¯æ´å®šä½';
            }
        }

        // è¼‰å…¥å‡ºå‹¤è¨˜éŒ„
        async function loadAttendanceHistory() {
            const token = localStorage.getItem('jwt_token');
            
            try {
                const response = await fetch('/api/attendance/history?limit=5', {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                
                if (response.ok) {
                    const history = await response.json();
                    const tbody = document.getElementById('attendance-history');
                    
                    if (history.length === 0) {
                        tbody.innerHTML = '<tr><td colspan="4" class="text-center">ç„¡è¨˜éŒ„</td></tr>';
                    } else {
                        tbody.innerHTML = history.map(record => `
                            <tr>
                                <td>${new Date(record.date).toLocaleDateString()}</td>
                                <td>${record.clock_in ? new Date(record.clock_in).toLocaleTimeString() : '--'}</td>
                                <td>${record.clock_out ? new Date(record.clock_out).toLocaleTimeString() : '--'}</td>
                                <td><span class="badge bg-success">æ­£å¸¸</span></td>
                            </tr>
                        `).join('');
                    }
                }
            } catch (error) {
                console.error('è¼‰å…¥å‡ºå‹¤è¨˜éŒ„å¤±æ•—:', error);
            }
        }

        // ä¸Šç­æ‰“å¡
        async function clockIn() {
            const token = localStorage.getItem('jwt_token');
            
            try {
                const response = await fetch('/api/attendance/clock-in', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        location: 'GPSå®šä½ä¸­...'
                    })
                });
                
                if (response.ok) {
                    alert('ä¸Šç­æ‰“å¡æˆåŠŸï¼');
                    loadDashboard();
                    loadAttendance();
                } else {
                    const error = await response.json();
                    alert('æ‰“å¡å¤±æ•—ï¼š' + error.message);
                }
            } catch (error) {
                alert('æ‰“å¡å¤±æ•—ï¼š' + error.message);
            }
        }

        // ä¸‹ç­æ‰“å¡
        async function clockOut() {
            const token = localStorage.getItem('jwt_token');
            
            try {
                const response = await fetch('/api/attendance/clock-out', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        location: 'GPSå®šä½ä¸­...'
                    })
                });
                
                if (response.ok) {
                    alert('ä¸‹ç­æ‰“å¡æˆåŠŸï¼');
                    loadDashboard();
                    loadAttendance();
                } else {
                    const error = await response.json();
                    alert('æ‰“å¡å¤±æ•—ï¼š' + error.message);
                }
            } catch (error) {
                alert('æ‰“å¡å¤±æ•—ï¼š' + error.message);
            }
        }

        // ==================== ç­è¡¨ç›¸é—œåŠŸèƒ½ ====================
        
        // é¡¯ç¤ºé€±ç­è¡¨
        function showWeekSchedule() {
            document.getElementById('week-schedule').classList.remove('d-none');
            document.getElementById('month-schedule').classList.add('d-none');
        }
        
        // é¡¯ç¤ºæœˆç­è¡¨
        function showMonthSchedule() {
            document.getElementById('week-schedule').classList.add('d-none');
            document.getElementById('month-schedule').classList.remove('d-none');
        }
        
        // è«‹å‡ç”³è«‹
        function requestLeave() {
            const html = `
                <form id="leave-request-form">
                    <div class="mb-3">
                        <label class="form-label">è«‹å‡é¡å‹</label>
                        <select class="form-select" id="leave-type" required>
                            <option value="">è«‹é¸æ“‡è«‹å‡é¡å‹</option>
                            <option value="annual">å¹´å‡</option>
                            <option value="sick">ç—…å‡</option>
                            <option value="personal">äº‹å‡</option>
                            <option value="maternity">ç”¢å‡</option>
                            <option value="paternity">é™ªç”¢å‡</option>
                            <option value="other">å…¶ä»–</option>
                        </select>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">èµ·å§‹æ—¥æœŸ</label>
                                <input type="date" class="form-control" id="leave-start-date" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">çµæŸæ—¥æœŸ</label>
                                <input type="date" class="form-control" id="leave-end-date" required>
                            </div>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">è«‹å‡åŸå› </label>
                        <textarea class="form-control" id="leave-reason" rows="3" placeholder="è«‹èªªæ˜è«‹å‡åŸå› ..." required></textarea>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">ä»£ç†äºº (é¸å¡«)</label>
                        <input type="text" class="form-control" id="leave-substitute" placeholder="ä»£ç†äººå§“å">
                    </div>
                </form>
            `;
            
            showModal('è«‹å‡ç”³è«‹', html, async () => {
                const formData = new FormData(document.getElementById('leave-request-form'));
                const leaveData = Object.fromEntries(formData);
                
                try {
                    const response = await fetch('/api/leave-requests', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${localStorage.getItem('jwt_token')}`
                        },
                        body: JSON.stringify(leaveData)
                    });
                    
                    if (response.ok) {
                        showAlert('è«‹å‡ç”³è«‹å·²æäº¤ï¼Œç­‰å¾…ä¸»ç®¡å¯©æ ¸', 'success');
                    } else {
                        showAlert('è«‹å‡ç”³è«‹å¤±æ•—', 'error');
                    }
                } catch (error) {
                    showAlert('è«‹å‡ç”³è«‹å¤±æ•—: ' + error.message, 'error');
                }
            });
        }
        
        // ==================== ç‡Ÿæ”¶ç›¸é—œåŠŸèƒ½ ====================
        
        // è™•ç†ç‡Ÿæ”¶è¡¨å–®æäº¤
        document.addEventListener('DOMContentLoaded', function() {
            const revenueForm = document.getElementById('revenue-form');
            if (revenueForm) {
                revenueForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    const formData = {
                        category: document.getElementById('revenue-category').value,
                        item: document.getElementById('revenue-item').value,
                        amount: parseFloat(document.getElementById('revenue-amount').value),
                        customer: document.getElementById('revenue-customer').value,
                        notes: document.getElementById('revenue-notes').value
                    };
                    
                    try {
                        const response = await fetch('/api/revenue', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                                'Authorization': `Bearer ${localStorage.getItem('jwt_token')}`
                            },
                            body: JSON.stringify(formData)
                        });
                        
                        if (response.ok) {
                            showAlert('ç‡Ÿæ”¶è¨˜éŒ„æ–°å¢æˆåŠŸ', 'success');
                            revenueForm.reset();
                            loadRevenueRecords();
                        } else {
                            showAlert('ç‡Ÿæ”¶è¨˜éŒ„æ–°å¢å¤±æ•—', 'error');
                        }
                    } catch (error) {
                        showAlert('ç‡Ÿæ”¶è¨˜éŒ„æ–°å¢å¤±æ•—: ' + error.message, 'error');
                    }
                });
            }
        });
        
        // è¼‰å…¥ç‡Ÿæ”¶è¨˜éŒ„
        async function loadRevenueRecords() {
            // é€™è£¡å¯ä»¥åŠ è¼‰å¯¦éš›çš„ç‡Ÿæ”¶è¨˜éŒ„æ•¸æ“š
            console.log('è¼‰å…¥ç‡Ÿæ”¶è¨˜éŒ„...');
        }
        
        // æŸ¥çœ‹ç‡Ÿæ”¶è©³æƒ…
        function viewRevenueDetail(id) {
            showAlert(`æŸ¥çœ‹ç‡Ÿæ”¶è¨˜éŒ„ ID: ${id}`, 'info');
        }
        
        // åŒ¯å‡ºç‡Ÿæ”¶æ•¸æ“š
        function exportRevenueData() {
            showAlert('æ­£åœ¨åŒ¯å‡ºç‡Ÿæ”¶æ•¸æ“š...', 'info');
        }
        
        // ==================== ç¶­ä¿®ç›¸é—œåŠŸèƒ½ ====================
        
        // è™•ç†ç¶­ä¿®è¡¨å–®æäº¤
        document.addEventListener('DOMContentLoaded', function() {
            const maintenanceForm = document.getElementById('maintenance-form');
            if (maintenanceForm) {
                maintenanceForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    const formData = {
                        equipment_type: document.getElementById('equipment-type').value,
                        priority: document.getElementById('priority-level').value,
                        location: document.getElementById('equipment-location').value,
                        contact_phone: document.getElementById('contact-phone').value,
                        title: document.getElementById('maintenance-title').value,
                        description: document.getElementById('maintenance-description').value
                    };
                    
                    try {
                        const response = await fetch('/api/maintenance', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                                'Authorization': `Bearer ${localStorage.getItem('jwt_token')}`
                            },
                            body: JSON.stringify(formData)
                        });
                        
                        if (response.ok) {
                            showAlert('ç¶­ä¿®ç”³è«‹å·²æäº¤ï¼Œå°‡åœ¨24å°æ™‚å…§è™•ç†', 'success');
                            maintenanceForm.reset();
                            loadMaintenanceRecords();
                        } else {
                            showAlert('ç¶­ä¿®ç”³è«‹æäº¤å¤±æ•—', 'error');
                        }
                    } catch (error) {
                        showAlert('ç¶­ä¿®ç”³è«‹æäº¤å¤±æ•—: ' + error.message, 'error');
                    }
                });
                
                // å­—æ•¸è¨ˆæ•¸å™¨
                const descriptionField = document.getElementById('maintenance-description');
                const charCount = document.getElementById('char-count');
                
                descriptionField.addEventListener('input', function() {
                    const remaining = 500 - this.value.length;
                    charCount.textContent = remaining;
                    charCount.className = remaining < 50 ? 'text-danger' : 'text-muted';
                });
            }
        });
        
        // è¼‰å…¥ç¶­ä¿®è¨˜éŒ„
        async function loadMaintenanceRecords() {
            console.log('è¼‰å…¥ç¶­ä¿®è¨˜éŒ„...');
        }
        
        // æŸ¥çœ‹ç¶­ä¿®è©³æƒ…
        function viewMaintenanceDetail(id) {
            showAlert(`æŸ¥çœ‹ç¶­ä¿®è©³æƒ… ID: ${id}`, 'info');
        }
        
        // å–æ¶ˆç¶­ä¿®ç”³è«‹
        function cancelMaintenance(id) {
            if (confirm('ç¢ºå®šè¦å–æ¶ˆé€™å€‹ç¶­ä¿®ç”³è«‹å—ï¼Ÿ')) {
                showAlert(`ç¶­ä¿®ç”³è«‹ ${id} å·²å–æ¶ˆ`, 'info');
            }
        }
        
        // ç¶­ä¿®ç‹€æ…‹ç¯©é¸
        function filterMaintenanceStatus(status) {
            const rows = document.querySelectorAll('#maintenance-records tr');
            
            rows.forEach(row => {
                if (status === 'all' || row.dataset.status === status) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }
        
        // ç¶­ä¿®è©•åˆ†
        function rateMaintenance(id) {
            showAlert(`ç¶­ä¿®è©•åˆ†åŠŸèƒ½ ID: ${id}`, 'info');
        }
        
        // ==================== é€šç”¨åŠŸèƒ½ ====================
        
        // é¡¯ç¤ºæ¨¡æ…‹æ¡†
        function showModal(title, content, onConfirm) {
            const modalHtml = `
                <div class="modal fade" id="dynamicModal" tabindex="-1">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">${title}</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                ${content}
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                                <button type="button" class="btn btn-primary" id="modal-confirm">ç¢ºèª</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHtml);
            
            const modal = new bootstrap.Modal(document.getElementById('dynamicModal'));
            
            document.getElementById('modal-confirm').addEventListener('click', async () => {
                if (onConfirm) {
                    await onConfirm();
                }
                modal.hide();
            });
            
            document.getElementById('dynamicModal').addEventListener('hidden.bs.modal', () => {
                document.getElementById('dynamicModal').remove();
            });
            
            modal.show();
        }
        
        // é¡¯ç¤ºæç¤ºè¨Šæ¯
        function showAlert(message, type = 'info') {
            const alertHtml = `
                <div class="alert alert-${type === 'error' ? 'danger' : type} alert-dismissible fade show position-fixed" 
                     style="top: 20px; right: 20px; z-index: 9999; max-width: 400px;">
                    ${message}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', alertHtml);
            
            // è‡ªå‹•æ¶ˆå¤±
            setTimeout(() => {
                const alerts = document.querySelectorAll('.alert');
                if (alerts.length > 0) {
                    alerts[alerts.length - 1].remove();
                }
            }, 5000);
        }
        
        // ä¿®æ”¹å¯†ç¢¼
        function changePassword() {
            const oldPassword = document.getElementById('old-password').value;
            const newPassword = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;
            
            if (!oldPassword || !newPassword || !confirmPassword) {
                showAlert('è«‹å¡«å¯«å®Œæ•´çš„å¯†ç¢¼è³‡æ–™', 'error');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                showAlert('æ–°å¯†ç¢¼ç¢ºèªä¸ä¸€è‡´', 'error');
                return;
            }
            
            showAlert('å¯†ç¢¼ä¿®æ”¹æˆåŠŸ', 'success');
        }

        // ç™»å‡º
        function logout() {
            localStorage.removeItem('jwt_token');
            localStorage.removeItem('user_data');
            window.location.href = '/login.html';
        }

        // é é¢è¼‰å…¥æ™‚åŸ·è¡Œ
        document.addEventListener('DOMContentLoaded', function() {
            if (checkEmployeeAuth()) {
                loadDashboard();
            }
        });
    </script>
</body>
</html>